<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta name="author" content="Jack Oliver">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width">
        <title>Solving Logic Puzzles in Prolog | Divide & Ponder</title>

	<link rel="shortcut icon" href="/favicon.ico?" type="image/x-icon">
	<link rel="icon" href="/favicon.ico?" type="image/x-icon">
        <link rel="alternate" type="application/atom+xml" title="Divide & Ponder blog atom feed" href="/feeds/all.atom.xml" />
        <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700' rel='stylesheet' type='text/css'>

        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
        <link rel="stylesheet" type="text/css" href="/theme/css/icons.css"/>
        <style>.highlight .hll { background-color: #ffffcc }
.highlight .c { color: #60a0b0; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #FF0000 } /* Error */
.highlight .k { color: #007020; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .cm { color: #60a0b0; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #007020 } /* Comment.Preproc */
.highlight .c1 { color: #60a0b0; font-style: italic } /* Comment.Single */
.highlight .cs { color: #60a0b0; background-color: #fff0f0 } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #FF0000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #00A000 } /* Generic.Inserted */
.highlight .go { color: #808080 } /* Generic.Output */
.highlight .gp { color: #c65d09; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0040D0 } /* Generic.Traceback */
.highlight .kc { color: #007020; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #007020; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #007020; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #007020 } /* Keyword.Pseudo */
.highlight .kr { color: #007020; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #902000 } /* Keyword.Type */
.highlight .m { color: #40a070 } /* Literal.Number */
.highlight .s { color: #4070a0 } /* Literal.String */
.highlight .na { color: #4070a0 } /* Name.Attribute */
.highlight .nb { color: #007020 } /* Name.Builtin */
.highlight .nc { color: #0e84b5; font-weight: bold } /* Name.Class */
.highlight .no { color: #60add5 } /* Name.Constant */
.highlight .nd { color: #555555; font-weight: bold } /* Name.Decorator */
.highlight .ni { color: #d55537; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #007020 } /* Name.Exception */
.highlight .nf { color: #06287e } /* Name.Function */
.highlight .nl { color: #002070; font-weight: bold } /* Name.Label */
.highlight .nn { color: #0e84b5; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #062873; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #bb60d5 } /* Name.Variable */
.highlight .ow { color: #007020; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mf { color: #40a070 } /* Literal.Number.Float */
.highlight .mh { color: #40a070 } /* Literal.Number.Hex */
.highlight .mi { color: #40a070 } /* Literal.Number.Integer */
.highlight .mo { color: #40a070 } /* Literal.Number.Oct */
.highlight .sb { color: #4070a0 } /* Literal.String.Backtick */
.highlight .sc { color: #4070a0 } /* Literal.String.Char */
.highlight .sd { color: #4070a0; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #4070a0 } /* Literal.String.Double */
.highlight .se { color: #4070a0; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #4070a0 } /* Literal.String.Heredoc */
.highlight .si { color: #70a0d0; font-style: italic } /* Literal.String.Interpol */
.highlight .sx { color: #c65d09 } /* Literal.String.Other */
.highlight .sr { color: #235388 } /* Literal.String.Regex */
.highlight .s1 { color: #4070a0 } /* Literal.String.Single */
.highlight .ss { color: #517918 } /* Literal.String.Symbol */
.highlight .bp { color: #007020 } /* Name.Builtin.Pseudo */
.highlight .vc { color: #bb60d5 } /* Name.Variable.Class */
.highlight .vg { color: #bb60d5 } /* Name.Variable.Global */
.highlight .vi { color: #bb60d5 } /* Name.Variable.Instance */
.highlight .il { color: #40a070 } /* Literal.Number.Integer.Long */</style>
        <style>body {
  margin: 0;
  padding: 0;
  font: 15px 'Source Sans Pro', sans-serif;
  line-height: 1.6em;
  color: #222;
  text-rendering: optimizeLegibility;
  -webkit-font-smoothing: antialiased;
}

a {
  color: #007EE5;
  text-decoration: none;
}
a:hover {
  color: #007EE5;
  text-decoration: none;
}
header.main-header {
  background: none repeat scroll 0% 0% #205F29;
  margin-bottom: 20px;
}
header.main-header a {
  color: #fff;
}
header.main-header .container {
  max-width: 1000px;
}
header.main-header .container nav a:hover {
  background-color: #5C881C;
}
article {
  margin: 0;
}
article header.about {
  margin-bottom: 0px;
  padding-bottom: 0px;
}
article header {
  margin-bottom: 20px;
  padding-bottom: 20px;
}
article header h1 {
  margin-bottom: 2px;
  font-weight: 700;
  color: #000;
}
article header time {
  color: #9E9E9E;
  font-size: 0.85em;
  float: right;
}
article header time.left {
  color: #9E9E9E;
  font-size: 0.85em;
  float: left;
}
article div.social-links ul {
  padding: 0px;
}
article div.social-links li {
  display: inline;
  font-size: 20px;
}
article div.social-links li a {
  color: #000;
  padding: 10px;
}
article div.social-links li a:hover {
  color: #666;
  text-decoration: none;
}
article p {
  font-size: 16px;
  margin-bottom: 20px;
  line-height: 1.6em;
}
article p.note {
  background: #f5f5f5;
  border: 1px solid #ddd;
  padding: 0.533em 0.733em;
}
article p.update {
  background-color: #FEEFB3;
  border: 1px solid #e6e68a;
  padding: 0.533em 0.733em;
}
article p.alert {
  background-color: #ffe2e2;
  border: 1px solid #ffb2b2;
  padding: 0.533em 0.733em;
}
article ul,
article ol {
  margin-top: 0px;
  margin-bottom: 25px;
}
article li {
  font-size: 16px;
  line-height: 1.6em;
}
article a:hover {
  text-decoration: underline;
}
article blockquote {
  border-left: 2px solid #c7c7cc;
  color: #666;
  margin: 30px 0;
  padding: 0 0 0 25px;
}
article img {
  max-width: 100%;
}
article code {
  color: #333;
  background-color: #EEE;
  border-radius: 0;
  font-size: 13px;
}
article .meta {
  font-size: 11px;
}
article .meta a:hover {
  text-decoration: none;
}
article .meta div {
  margin-bottom: 20px;
  display: block;
}
article .meta a.tag {
  margin: 0 10px 10px 0;
  padding: 1px 12px;
  display: inline-block;
  font-size: 14px;
  color: rgba(0, 0, 0, 0.8);
  background: rgba(0, 0, 0, 0.05);
}
article .meta a.tag:hover {
  background: rgba(0, 0, 0, 0.15);
}
article .meta a.read_more,
article .meta a.comments_btn {
  font-size: 14px;
  font-weight: 800;
  padding: 10px 20px;
  color: #205F29;
  background: #FFF;
  border: 1px solid #205F29;
}
article .meta a.read_more:hover,
article .meta a.comments_btn:hover {
  color: #FFF;
  background: #5C881C;
}
.index {
  max-width: 700px;
}
.index article header h2 {
  font-size: 36px;
  margin-bottom: 2px;
  font-weight: 700;
}
h2 code {
  font-size: 26px;
  font-weight: 400;
}
h3 code {
  font-size: 20px;
  font-weight: 400;
}
.index article header h2 a {
  color: #000;
}
.index article header h2 a:hover {
  color: #007EE5;
  text-decoration: none;
}
.index .separator {
  padding: 40px 0 0 0;
  margin: 0 0 40px 0;
  height: 10px;
  border-bottom: solid 1px #CCC;
}
.index .pagination {
  display: block;
  margin-bottom: 100px;
}
.index .pagination .left {
  text-align: right;
}
.index .pagination .right {
  text-align: left;
}
.index .pagination a {
  display: inline-block;
  border: 2px solid #5C881C;
  margin: 0 5px;
  padding: 8px 20px;
  font-weight: bold;
  color: #5C881C;
}
.index .pagination a:hover {
  color: #FFF;
  background: #5C881C;
}
.post {
  max-width: 700px;
}
.post h2:before {
  content: "# ";
  font-weight: bold;
  color: #DDD;
}
.post h3:before {
  content: "## ";
  font-weight: bold;
  color: #DDD;
}
.post h4:before {
  content: "### ";
  font-weight: bold;
  color: #DDD;
}
.post article .meta {
  margin: 50px 0 100px;
}
.list {
  max-width: 700px;
}
.list ul.double-list {
  margin: 0 auto 60px;
  padding: 0;
  list-style-type: none;
}
.list ul.double-list li {
  padding: 5px 0;
}
.list ul.double-list li h2 {
  font-size: 1em;
  display: inline;
  font-weight: normal;
}
.list ul.double-list li span {
  font-family: sans-serif;
  text-transform: uppercase;
  text-align: right;
  float: right;
  padding-top: 3px;
  font-size: 12px;
  color: #999;
}
.full-width-content {
  padding-top: 10px;
  padding-left: 0px;
  padding-right: 0px;
  margin-left: -20px;
  margin-right: -20px;
}
.col-xs-1,
.col-sm-1,
.col-md-1,
.col-lg-1,
.col-xs-2,
.col-sm-2,
.col-md-2,
.col-lg-2,
.col-xs-3,
.col-sm-3,
.col-md-3,
.col-lg-3,
.col-xs-4,
.col-sm-4,
.col-md-4,
.col-lg-4,
.col-xs-5,
.col-sm-5,
.col-md-5,
.col-lg-5,
.col-xs-6,
.col-sm-6,
.col-md-6,
.col-lg-6,
.col-xs-7,
.col-sm-7,
.col-md-7,
.col-lg-7,
.col-xs-8,
.col-sm-8,
.col-md-8,
.col-lg-8,
.col-xs-9,
.col-sm-9,
.col-md-9,
.col-lg-9,
.col-xs-10,
.col-sm-10,
.col-md-10,
.col-lg-10,
.col-xs-11,
.col-sm-11,
.col-md-11,
.col-lg-11,
.col-xs-12,
.col-sm-12,
.col-md-12,
.col-lg-12 {
  padding-right: 0px;
  padding-left: 0px;
}

figure {
  text-align: center;
}

td.code {
  width: 100%;
}

figure.code {
  text-align: left;
}

figure.styled {
  padding-top: 1rem;
  padding-bottom: 1rem;
  padding-left: 2rem;
  padding-right: 2rem;
  margin-left: -2rem;
  margin-right: -2rem;
  background: repeating-linear-gradient(135deg, #dfdfdf 0, #dfdfdf 1%, #ffffff 0, #ffffff 50%) 0 / 20px 20px;
  text-align: center;
  img {
      margin: 0 auto 0.2rem auto;
      border: 1px solid #ddd;
      box-shadow: none;
      background-color: #fff;
  }
}
figcaption {
  text-align: center;
  font-size: 1.2rem;
  padding-left: 2rem;
  padding-right: 2rem;
  line-height: 1.6;
  font-family: Consolas, monaco, monospace;
  span {
      background-color: #fff;
      padding: 0.2rem 0.5rem;
  }
  a:hover {
      cursor: pointer;
  }
}

.vis-container {
  padding-top: 1rem;
  padding-bottom: 1rem;
  padding-left: 2rem;
  padding-right: 2rem;
  margin-left: -2rem;
  margin-right: -2rem;
  background: repeating-linear-gradient(135deg, #dfdfdf 0, #dfdfdf 1%, #ffffff 0, #ffffff 50%) 0 / 20px 20px;
  width: 100%;
  margin:0 auto;
}

#cent {
  text-align: center;
}

.proj-contents {
  width: 80%;
  text-align: left;
  padding: 2%;
  /* justify-content: flex-start; */
}

.proj-contents p {
  margin: 0;
}

.paperimg {
  object-fit: cover;
  width: 100%;
  height: 100px;
  z-index: 1;
}

.proj-img {
  width: 20%;
  height: 100%;
}

.proj-row {
  width: 100%;
  display: flex;
  flex-direction: row;
  justify-content: space-between;
  align-items: center;
  background: rgb(228, 228, 228);
}

.projs {
  display: flex;
  flex-direction: column;
  /* background: rgb(241, 241, 241); */
  padding: 2%;
  row-gap: 25px;
  /* align-items: flex-start; */
  width: 100%;
  margin: 0 auto;
}</style>

	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script src="https://kit.fontawesome.com/efe339fa46.js" crossorigin="anonymous"></script>

    <!-- importing Vega-Lite -->
    <script src="https://cdn.jsdelivr.net/npm/vega@5"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-lite@5"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-embed@6"></script>

        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
        <script type="text/javascript">
        init_mathjax = function() {
            if (window.MathJax) {
                // MathJax loaded
                MathJax.Hub.Config({
                    jax: ["input/TeX", "output/CommonHTML", "output/HTML-CSS"],
                    tex: {
                        packages: {'[+]': ['boldsymbol', 'amsmath']}
                    },
                    tex2jax: {
                        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
                        displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
                        processEscapes: true
                    },
                    displayAlign: 'center', // Change this to 'center' to center equations.
                    "HTML-CSS": {
                        styles: {'.MathJax_Display': {"margin": 0}}
                    }
                });
                MathJax.Hub.Queue(["Typeset",MathJax.Hub]);
            }
        }
        init_mathjax();
        </script>
    </head>

    <body>
        <header class="navbar navbar-inverse bs-docs-nav">
            <div class="container-fluid">
                <div class="navbar-header">
		  <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#theNavbar">
		    <span class="icon-bar"></span>
		    <span class="icon-bar"></span>
		    <span class="icon-bar"></span> 
		  </button>
                  <a class="navbar-brand" href="/" title="Home" class="title">Divide & Ponder</a>
                </div>
                <nav class="collapse navbar-collapse bs-navbar-collapse" role="navigation" id="theNavbar">
		            <ul class="nav navbar-nav navbar-right">
                        <li class="dropdown">
                            <a data-target="/" href="/" class="dropdown-toggle" data-toggle="dropdown">Blog <b class="caret"></b></a>
                            <ul class="dropdown-menu">
                              <li><a href="/">Divide & Ponder</a></li>
                              <li><a href="https://medium.com/@jack_oliver" target="_blank">Medium</a></li>
                            </ul>
                        </li>
                        <li><a href="/pages/papers.html" title="Papers">Papers</a></li>
                        <li><a href="/pages/lightning-articles.html" title="Lightning articles">⚡</a></li>
                        <li><a href="/pages/write-ups.html" title="Write-ups">Write-ups</a></li>
                            <li><a href="/pages/about.html" title="About">About</a></li>
                            <li><a href="/archives.html" title="Archive">Archive</a></li>
                    </ul>
                </nav>
            </div>
        </header>

        <div id="wrap">
<div class="container post">
    <article>
        <header>
            <h1>Solving Logic Puzzles in Prolog</h1>
            <time datetime="article.date.isoformat()" pubdate>Sat 01 July 2023</time>

        </header>

        <div class="article_content">
            

<figure class="styled"><img class="styled" src="/images/futoshiki_splash.png" width="250" height="250" title="A solved 7x7 Futoshiki board." alt="A solved 7x7 Futoshiki board."><figcaption>A solved 7x7 Futoshiki board.</figcaption></figure>

<p>Recently, I came across this fun brainteaser on <a href="https://mathematicaloddsandends.wordpress.com/2022/01/01/a-brainteaser-involving-prime-sums-and-differences/" target="_blank">Kenneth Tay's blog</a>:</p>
<blockquote>
<p>Write the numbers 1 to 14 around a circle so that the sum and difference of every pair of adjacent numbers is prime.</p>
</blockquote>
<p>In this blog post, I want to use this riddle as an example to show how <em>easy</em> it can be to solve logic puzzles out-of-the-box with Prolog: a constraint logic programming language. Alongside this riddle, I'll cover two additional games that aren't as easy, and showcase how Prolog can allow for intuitive, declarative solutions to nontrivial problems.</p>


<style type="text/css">/*!
*
* IPython notebook
*
*/
/* CSS font colors for translated ANSI escape sequences */
/* The color values are a mix of
   http://www.xcolors.net/dl/baskerville-ivorylight and
   http://www.xcolors.net/dl/euphrasia */
.ansi-black-fg {
  color: #3E424D;
}
.ansi-black-bg {
  background-color: #3E424D;
}
.ansi-black-intense-fg {
  color: #282C36;
}
.ansi-black-intense-bg {
  background-color: #282C36;
}
.ansi-red-fg {
  color: #E75C58;
}
.ansi-red-bg {
  background-color: #E75C58;
}
.ansi-red-intense-fg {
  color: #B22B31;
}
.ansi-red-intense-bg {
  background-color: #B22B31;
}
.ansi-green-fg {
  color: #00A250;
}
.ansi-green-bg {
  background-color: #00A250;
}
.ansi-green-intense-fg {
  color: #007427;
}
.ansi-green-intense-bg {
  background-color: #007427;
}
.ansi-yellow-fg {
  color: #DDB62B;
}
.ansi-yellow-bg {
  background-color: #DDB62B;
}
.ansi-yellow-intense-fg {
  color: #B27D12;
}
.ansi-yellow-intense-bg {
  background-color: #B27D12;
}
.ansi-blue-fg {
  color: #208FFB;
}
.ansi-blue-bg {
  background-color: #208FFB;
}
.ansi-blue-intense-fg {
  color: #0065CA;
}
.ansi-blue-intense-bg {
  background-color: #0065CA;
}
.ansi-magenta-fg {
  color: #D160C4;
}
.ansi-magenta-bg {
  background-color: #D160C4;
}
.ansi-magenta-intense-fg {
  color: #A03196;
}
.ansi-magenta-intense-bg {
  background-color: #A03196;
}
.ansi-cyan-fg {
  color: #60C6C8;
}
.ansi-cyan-bg {
  background-color: #60C6C8;
}
.ansi-cyan-intense-fg {
  color: #258F8F;
}
.ansi-cyan-intense-bg {
  background-color: #258F8F;
}
.ansi-white-fg {
  color: #C5C1B4;
}
.ansi-white-bg {
  background-color: #C5C1B4;
}
.ansi-white-intense-fg {
  color: #A1A6B2;
}
.ansi-white-intense-bg {
  background-color: #A1A6B2;
}
.ansi-default-inverse-fg {
  color: #FFFFFF;
}
.ansi-default-inverse-bg {
  background-color: #000000;
}
.ansi-bold {
  font-weight: bold;
}
.ansi-underline {
  text-decoration: underline;
}
/* The following styles are deprecated an will be removed in a future version */
.ansibold {
  font-weight: bold;
}
.ansi-inverse {
  outline: 0.5px dotted;
}
/* use dark versions for foreground, to improve visibility */
.ansiblack {
  color: black;
}
.ansired {
  color: darkred;
}
.ansigreen {
  color: darkgreen;
}
.ansiyellow {
  color: #c4a000;
}
.ansiblue {
  color: darkblue;
}
.ansipurple {
  color: darkviolet;
}
.ansicyan {
  color: steelblue;
}
.ansigray {
  color: gray;
}
/* and light for background, for the same reason */
.ansibgblack {
  background-color: black;
}
.ansibgred {
  background-color: red;
}
.ansibggreen {
  background-color: green;
}
.ansibgyellow {
  background-color: yellow;
}
.ansibgblue {
  background-color: blue;
}
.ansibgpurple {
  background-color: magenta;
}
.ansibgcyan {
  background-color: cyan;
}
.ansibggray {
  background-color: gray;
}
div.cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  border-radius: 2px;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  border-width: 1px;
  border-style: solid;
  border-color: transparent;
  width: 100%;
  padding: 5px;
  /* This acts as a spacer between cells, that is outside the border */
  margin: 0px;
  outline: none;
  position: relative;
  overflow: visible;
}
div.cell:before {
  position: absolute;
  display: block;
  top: -1px;
  left: -1px;
  width: 5px;
  height: calc(100% +  2px);
  content: '';
  background: transparent;
}
div.cell.jupyter-soft-selected {
  border-left-color: #E3F2FD;
  border-left-width: 1px;
  padding-left: 5px;
  border-right-color: #E3F2FD;
  border-right-width: 1px;
  background: #E3F2FD;
}
@media print {
  div.cell.jupyter-soft-selected {
    border-color: transparent;
  }
}
div.cell.selected,
div.cell.selected.jupyter-soft-selected {
  border-color: #ababab;
}
div.cell.selected:before,
div.cell.selected.jupyter-soft-selected:before {
  position: absolute;
  display: block;
  top: -1px;
  left: -1px;
  width: 5px;
  height: calc(100% +  2px);
  content: '';
  background: #42A5F5;
}
@media print {
  div.cell.selected,
  div.cell.selected.jupyter-soft-selected {
    border-color: transparent;
  }
}
.edit_mode div.cell.selected {
  border-color: #66BB6A;
}
.edit_mode div.cell.selected:before {
  position: absolute;
  display: block;
  top: -1px;
  left: -1px;
  width: 5px;
  height: calc(100% +  2px);
  content: '';
  background: #66BB6A;
}
@media print {
  .edit_mode div.cell.selected {
    border-color: transparent;
  }
}
.prompt {
  /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */
  min-width: 14ex;
  /* This padding is tuned to match the padding on the CodeMirror editor. */
  padding: 0.4em;
  margin: 0px;
  font-family: monospace;
  text-align: right;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
  /* Don't highlight prompt number selection */
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  /* Use default cursor */
  cursor: default;
}
@media (max-width: 540px) {
  .prompt {
    text-align: left;
  }
}
div.inner_cell {
  min-width: 0;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_area {
  border: 1px solid #cfcfcf;
  border-radius: 2px;
  background: #f7f7f7;
  line-height: 1.21429em;
}
/* This is needed so that empty prompt areas can collapse to zero height when there
   is no content in the output_subarea and the prompt. The main purpose of this is
   to make sure that empty JavaScript output_subareas have no height. */
div.prompt:empty {
  padding-top: 0;
  padding-bottom: 0;
}
div.unrecognized_cell {
  padding: 5px 5px 5px 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.unrecognized_cell .inner_cell {
  border-radius: 2px;
  padding: 5px;
  font-weight: bold;
  color: red;
  border: 1px solid #cfcfcf;
  background: #eaeaea;
}
div.unrecognized_cell .inner_cell a {
  color: inherit;
  text-decoration: none;
}
div.unrecognized_cell .inner_cell a:hover {
  color: inherit;
  text-decoration: none;
}
@media (max-width: 540px) {
  div.unrecognized_cell > div.prompt {
    display: none;
  }
}
div.code_cell {
  /* avoid page breaking on code cells when printing */
}
@media print {
  div.code_cell {
    page-break-inside: avoid;
  }
}
/* any special styling for code cells that are currently running goes here */
div.input {
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.input {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_prompt {
  color: #303F9F;
  border-top: 1px solid transparent;
}
div.input_area > div.highlight {
  margin: 0.4em;
  border: none;
  padding: 0px;
  background-color: transparent;
}
div.input_area > div.highlight > pre {
  margin: 0px;
  border: none;
  padding: 0px;
  background-color: transparent;
}
/* The following gets added to the <head> if it is detected that the user has a
 * monospace font with inconsistent normal/bold/italic height.  See
 * notebookmain.js.  Such fonts will have keywords vertically offset with
 * respect to the rest of the text.  The user should select a better font.
 * See: https://github.com/ipython/ipython/issues/1503
 *
 * .CodeMirror span {
 *      vertical-align: bottom;
 * }
 */
.CodeMirror {
  line-height: 1.21429em;
  /* Changed from 1em to our global default */
  font-size: 14px;
  height: auto;
  /* Changed to auto to autogrow */
  background: none;
  /* Changed from white to allow our bg to show through */
}
.CodeMirror-scroll {
  /*  The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/
  /*  We have found that if it is visible, vertical scrollbars appear with font size changes.*/
  overflow-y: hidden;
  overflow-x: auto;
}
.CodeMirror-lines {
  /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */
  /* we have set a different line-height and want this to scale with that. */
  /* Note that this should set vertical padding only, since CodeMirror assumes
       that horizontal padding will be set on CodeMirror pre */
  padding: 0.4em 0;
}
.CodeMirror-linenumber {
  padding: 0 8px 0 4px;
}
.CodeMirror-gutters {
  border-bottom-left-radius: 2px;
  border-top-left-radius: 2px;
}
.CodeMirror pre {
  /* In CM3 this went to 4px from 0 in CM2. This sets horizontal padding only,
    use .CodeMirror-lines for vertical */
  padding: 0 0.4em;
  border: 0;
  border-radius: 0;
}
.CodeMirror-cursor {
  border-left: 1.4px solid black;
}
@media screen and (min-width: 2138px) and (max-width: 4319px) {
  .CodeMirror-cursor {
    border-left: 2px solid black;
  }
}
@media screen and (min-width: 4320px) {
  .CodeMirror-cursor {
    border-left: 4px solid black;
  }
}
/*

Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org>
Adapted from GitHub theme

*/
.highlight-base {
  color: #000;
}
.highlight-variable {
  color: #000;
}
.highlight-variable-2 {
  color: #1a1a1a;
}
.highlight-variable-3 {
  color: #333333;
}
.highlight-string {
  color: #BA2121;
}
.highlight-comment {
  color: #408080;
  font-style: italic;
}
.highlight-number {
  color: #080;
}
.highlight-atom {
  color: #88F;
}
.highlight-keyword {
  color: #008000;
  font-weight: bold;
}
.highlight-builtin {
  color: #008000;
}
.highlight-error {
  color: #f00;
}
.highlight-operator {
  color: #AA22FF;
  font-weight: bold;
}
.highlight-meta {
  color: #AA22FF;
}
/* previously not defined, copying from default codemirror */
.highlight-def {
  color: #00f;
}
.highlight-string-2 {
  color: #f50;
}
.highlight-qualifier {
  color: #555;
}
.highlight-bracket {
  color: #997;
}
.highlight-tag {
  color: #170;
}
.highlight-attribute {
  color: #00c;
}
.highlight-header {
  color: blue;
}
.highlight-quote {
  color: #090;
}
.highlight-link {
  color: #00c;
}
/* apply the same style to codemirror */
.cm-s-ipython span.cm-keyword {
  color: #008000;
  font-weight: bold;
}
.cm-s-ipython span.cm-atom {
  color: #88F;
}
.cm-s-ipython span.cm-number {
  color: #080;
}
.cm-s-ipython span.cm-def {
  color: #00f;
}
.cm-s-ipython span.cm-variable {
  color: #000;
}
.cm-s-ipython span.cm-operator {
  color: #AA22FF;
  font-weight: bold;
}
.cm-s-ipython span.cm-variable-2 {
  color: #1a1a1a;
}
.cm-s-ipython span.cm-variable-3 {
  color: #333333;
}
.cm-s-ipython span.cm-comment {
  color: #408080;
  font-style: italic;
}
.cm-s-ipython span.cm-string {
  color: #BA2121;
}
.cm-s-ipython span.cm-string-2 {
  color: #f50;
}
.cm-s-ipython span.cm-meta {
  color: #AA22FF;
}
.cm-s-ipython span.cm-qualifier {
  color: #555;
}
.cm-s-ipython span.cm-builtin {
  color: #008000;
}
.cm-s-ipython span.cm-bracket {
  color: #997;
}
.cm-s-ipython span.cm-tag {
  color: #170;
}
.cm-s-ipython span.cm-attribute {
  color: #00c;
}
.cm-s-ipython span.cm-header {
  color: blue;
}
.cm-s-ipython span.cm-quote {
  color: #090;
}
.cm-s-ipython span.cm-link {
  color: #00c;
}
.cm-s-ipython span.cm-error {
  color: #f00;
}
.cm-s-ipython span.cm-tab {
  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=);
  background-position: right;
  background-repeat: no-repeat;
}
div.output_wrapper {
  /* this position must be relative to enable descendents to be absolute within it */
  position: relative;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  z-index: 1;
}
/* class for the output area when it should be height-limited */
div.output_scroll {
  /* ideally, this would be max-height, but FF barfs all over that */
  height: 24em;
  /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */
  width: 100%;
  overflow: auto;
  border-radius: 2px;
  -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  display: block;
}
/* output div while it is collapsed */
div.output_collapsed {
  margin: 0px;
  padding: 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
div.out_prompt_overlay {
  height: 100%;
  padding: 0px 0.4em;
  position: absolute;
  border-radius: 2px;
}
div.out_prompt_overlay:hover {
  /* use inner shadow to get border that is computed the same on WebKit/FF */
  -webkit-box-shadow: inset 0 0 1px #000;
  box-shadow: inset 0 0 1px #000;
  background: rgba(240, 240, 240, 0.5);
}
div.output_prompt {
  color: #D84315;
}
/* This class is the outer container of all output sections. */
div.output_area {
  padding: 0px;
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.output_area .MathJax_Display {
  text-align: left !important;
}
div.output_area 
div.output_area 
div.output_area img,
div.output_area svg {
  max-width: 100%;
  height: auto;
}
div.output_area img.unconfined,
div.output_area svg.unconfined {
  max-width: none;
}
div.output_area .mglyph > img {
  max-width: none;
}
/* This is needed to protect the pre formating from global settings such
   as that of bootstrap */
.output {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.output_area {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
div.output_area pre {
  margin: 0;
  padding: 1px 0 1px 0;
  border: 0;
  vertical-align: baseline;
  color: black;
  background-color: transparent;
  border-radius: 0;
}
/* This class is for the output subarea inside the output_area and after
   the prompt div. */
div.output_subarea {
  overflow-x: auto;
  padding: 0.4em;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
  max-width: calc(100% - 14ex);
}
div.output_scroll div.output_subarea {
  overflow-x: visible;
}
/* The rest of the output_* classes are for special styling of the different
   output types */
/* all text output has this class: */
div.output_text {
  text-align: left;
  color: #000;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
}
/* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */
div.output_stderr {
  background: #fdd;
  /* very light red background for stderr */
}
div.output_latex {
  text-align: left;
}
/* Empty output_javascript divs should have no height */
div.output_javascript:empty {
  padding: 0;
}
.js-error {
  color: darkred;
}
/* raw_input styles */
div.raw_input_container {
  line-height: 1.21429em;
  padding-top: 5px;
}
pre.raw_input_prompt {
  /* nothing needed here. */
}
input.raw_input {
  font-family: monospace;
  font-size: inherit;
  color: inherit;
  width: auto;
  /* make sure input baseline aligns with prompt */
  vertical-align: baseline;
  /* padding + margin = 0.5em between prompt and cursor */
  padding: 0em 0.25em;
  margin: 0em 0.25em;
}
input.raw_input:focus {
  box-shadow: none;
}
p.p-space {
  margin-bottom: 10px;
}
div.output_unrecognized {
  padding: 5px;
  font-weight: bold;
  color: red;
}
div.output_unrecognized a {
  color: inherit;
  text-decoration: none;
}
div.output_unrecognized a:hover {
  color: inherit;
  text-decoration: none;
}
.rendered_html {
  color: #000;
  /* any extras will just be numbers: */
}



.rendered_html :link {
  text-decoration: underline;
}
.rendered_html :visited {
  text-decoration: underline;
}






.rendered_html h1:first-child {
  margin-top: 0.538em;
}
.rendered_html h2:first-child {
  margin-top: 0.636em;
}
.rendered_html h3:first-child {
  margin-top: 0.777em;
}
.rendered_html h4:first-child {
  margin-top: 1em;
}
.rendered_html h5:first-child {
  margin-top: 1em;
}
.rendered_html h6:first-child {
  margin-top: 1em;
}
.rendered_html ul:not(.list-inline),
.rendered_html ol:not(.list-inline) {
  padding-left: 2em;
}








.rendered_html * + ul {
  margin-top: 1em;
}
.rendered_html * + ol {
  margin-top: 1em;
}





.rendered_html pre,




.rendered_html tr,
.rendered_html th,


.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
.rendered_html * + table {
  margin-top: 1em;
}

.rendered_html * + p {
  margin-top: 1em;
}

.rendered_html * + img {
  margin-top: 1em;
}
.rendered_html img,

.rendered_html img.unconfined,


.rendered_html * + .alert {
  margin-top: 1em;
}
[dir="rtl"] 
div.text_cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.text_cell > div.prompt {
    display: none;
  }
}
div.text_cell_render {
  /*font-family: "Helvetica Neue", Arial, Helvetica, Geneva, sans-serif;*/
  outline: none;
  resize: none;
  width: inherit;
  border-style: none;
  padding: 0.5em 0.5em 0.5em 0.4em;
  color: #000;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
}
a.anchor-link:link {
  text-decoration: none;
  padding: 0px 20px;
  visibility: hidden;
}
h1:hover .anchor-link,
h2:hover .anchor-link,
h3:hover .anchor-link,
h4:hover .anchor-link,
h5:hover .anchor-link,
h6:hover .anchor-link {
  visibility: visible;
}
.text_cell.rendered .input_area {
  display: none;
}
.text_cell.rendered 
.text_cell.rendered .rendered_html tr,
.text_cell.rendered .rendered_html th,
.text_cell.rendered 
.text_cell.unrendered .text_cell_render {
  display: none;
}
.text_cell .dropzone .input_area {
  border: 2px dashed #bababa;
  margin: -1px;
}
.cm-header-1,
.cm-header-2,
.cm-header-3,
.cm-header-4,
.cm-header-5,
.cm-header-6 {
  font-weight: bold;
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
}
.cm-header-1 {
  font-size: 185.7%;
}
.cm-header-2 {
  font-size: 157.1%;
}
.cm-header-3 {
  font-size: 128.6%;
}
.cm-header-4 {
  font-size: 110%;
}
.cm-header-5 {
  font-size: 100%;
  font-style: italic;
}
.cm-header-6 {
  font-size: 100%;
  font-style: italic;
}
</style>
<style type="text/css">pre { line-height: 125%; }
td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
 .highlight pre  .hll { background-color: #ffffcc }
 .highlight pre  { background: #f8f8f8; }
 .highlight pre  .c { color: #3D7B7B; font-style: italic } /* Comment */
 .highlight pre  .err { border: 1px solid #FF0000 } /* Error */
 .highlight pre  .k { color: #008000; font-weight: bold } /* Keyword */
 .highlight pre  .o { color: #666666 } /* Operator */
 .highlight pre  .ch { color: #3D7B7B; font-style: italic } /* Comment.Hashbang */
 .highlight pre  .cm { color: #3D7B7B; font-style: italic } /* Comment.Multiline */
 .highlight pre  .cp { color: #9C6500 } /* Comment.Preproc */
 .highlight pre  .cpf { color: #3D7B7B; font-style: italic } /* Comment.PreprocFile */
 .highlight pre  .c1 { color: #3D7B7B; font-style: italic } /* Comment.Single */
 .highlight pre  .cs { color: #3D7B7B; font-style: italic } /* Comment.Special */
 .highlight pre  .gd { color: #A00000 } /* Generic.Deleted */
 .highlight pre  .ge { font-style: italic } /* Generic.Emph */
 .highlight pre  .gr { color: #E40000 } /* Generic.Error */
 .highlight pre  .gh { color: #000080; font-weight: bold } /* Generic.Heading */
 .highlight pre  .gi { color: #008400 } /* Generic.Inserted */
 .highlight pre  .go { color: #717171 } /* Generic.Output */
 .highlight pre  .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
 .highlight pre  .gs { font-weight: bold } /* Generic.Strong */
 .highlight pre  .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
 .highlight pre  .gt { color: #0044DD } /* Generic.Traceback */
 .highlight pre  .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
 .highlight pre  .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
 .highlight pre  .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
 .highlight pre  .kp { color: #008000 } /* Keyword.Pseudo */
 .highlight pre  .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
 .highlight pre  .kt { color: #B00040 } /* Keyword.Type */
 .highlight pre  .m { color: #666666 } /* Literal.Number */
 .highlight pre  .s { color: #BA2121 } /* Literal.String */
 .highlight pre  .na { color: #687822 } /* Name.Attribute */
 .highlight pre  .nb { color: #008000 } /* Name.Builtin */
 .highlight pre  .nc { color: #0000FF; font-weight: bold } /* Name.Class */
 .highlight pre  .no { color: #880000 } /* Name.Constant */
 .highlight pre  .nd { color: #AA22FF } /* Name.Decorator */
 .highlight pre  .ni { color: #717171; font-weight: bold } /* Name.Entity */
 .highlight pre  .ne { color: #CB3F38; font-weight: bold } /* Name.Exception */
 .highlight pre  .nf { color: #0000FF } /* Name.Function */
 .highlight pre  .nl { color: #767600 } /* Name.Label */
 .highlight pre  .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
 .highlight pre  .nt { color: #008000; font-weight: bold } /* Name.Tag */
 .highlight pre  .nv { color: #19177C } /* Name.Variable */
 .highlight pre  .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
 .highlight pre  .w { color: #bbbbbb } /* Text.Whitespace */
 .highlight pre  .mb { color: #666666 } /* Literal.Number.Bin */
 .highlight pre  .mf { color: #666666 } /* Literal.Number.Float */
 .highlight pre  .mh { color: #666666 } /* Literal.Number.Hex */
 .highlight pre  .mi { color: #666666 } /* Literal.Number.Integer */
 .highlight pre  .mo { color: #666666 } /* Literal.Number.Oct */
 .highlight pre  .sa { color: #BA2121 } /* Literal.String.Affix */
 .highlight pre  .sb { color: #BA2121 } /* Literal.String.Backtick */
 .highlight pre  .sc { color: #BA2121 } /* Literal.String.Char */
 .highlight pre  .dl { color: #BA2121 } /* Literal.String.Delimiter */
 .highlight pre  .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
 .highlight pre  .s2 { color: #BA2121 } /* Literal.String.Double */
 .highlight pre  .se { color: #AA5D1F; font-weight: bold } /* Literal.String.Escape */
 .highlight pre  .sh { color: #BA2121 } /* Literal.String.Heredoc */
 .highlight pre  .si { color: #A45A77; font-weight: bold } /* Literal.String.Interpol */
 .highlight pre  .sx { color: #008000 } /* Literal.String.Other */
 .highlight pre  .sr { color: #A45A77 } /* Literal.String.Regex */
 .highlight pre  .s1 { color: #BA2121 } /* Literal.String.Single */
 .highlight pre  .ss { color: #19177C } /* Literal.String.Symbol */
 .highlight pre  .bp { color: #008000 } /* Name.Builtin.Pseudo */
 .highlight pre  .fm { color: #0000FF } /* Name.Function.Magic */
 .highlight pre  .vc { color: #19177C } /* Name.Variable.Class */
 .highlight pre  .vg { color: #19177C } /* Name.Variable.Global */
 .highlight pre  .vi { color: #19177C } /* Name.Variable.Instance */
 .highlight pre  .vm { color: #19177C } /* Name.Variable.Magic */
 .highlight pre  .il { color: #666666 } /* Literal.Number.Integer.Long */</style><div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Table-of-contents">Table of contents<a class="anchor-link" href="#Table-of-contents">&#182;</a></h2><ol>
<li><a href="#Circular-primes">Circular primes</a><ol>
<li><a href="#Prolog-introduction-and-logical-primality-tests">Prolog introduction and logical primality tests</a></li>
<li><a href="#Translating-satisfiable-conditions">Translating satisfiable conditions</a></li>
<li><a href="#Bringing-it-all-together">Bringing it all together</a></li>
<li><a href="#A-technical-note-on-implementation">A technical note on implementation</a></li>
</ol>
</li>
<li><a href="#Futoshiki">Futoshiki</a><ol>
<li><a href="#Representing-the-game-board">Representing the game board</a></li>
<li><a href="#Prolog-arithmetic">Prolog arithmetic</a></li>
<li><a href="#Solving-Futoshiki">Solving Futoshiki</a></li>
<li><a href="#Testing-the-solution">Testing the solution</a></li>
</ol>
</li>
<li><a href="#NYT-Digits">NYT Digits</a><ol>
<li><a href="#Prolog-arithmetic,-part-two">Prolog arithmetic, part two</a></li>
<li><a href="#Solving-Digits">Solving Digits</a></li>
</ol>
</li>
<li><a href="#Conclusion">Conclusion</a></li>
</ol>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Circular-primes">Circular primes<a class="anchor-link" href="#Circular-primes">&#182;</a></h2><p>The above riddle is an example of a <em>constraint satisfaction problem</em> (CSP), a special type of problem in which variables that have domains must be allocated values to satisfy some set of constraints. In the case of this particular riddle, we could model the 14 positions on the circle as variables $x_0,x_1,\dots,x_{13}$ (where we consider $x_{13}$ and $x_0$ to be neighbors), and the domain for each variable would be the integers 1–14.</p>
<p>The puzzle essentially boils down to two constraints on the variables: (1) each number from 1–14 must be used exactly once, and (2) the sum and difference of every pair of adjacent numbers must be prime. With these two constraints in mind, we can work toward building a general solver for the problem.</p>
<h3 id="Prolog-introduction-and-logical-primality-tests">Prolog introduction and logical primality tests<a class="anchor-link" href="#Prolog-introduction-and-logical-primality-tests">&#182;</a></h3><p>First, we'll need a way to identify primes. Prolog is a logic programming language, so it operates with <em>predicates</em> instead of <em>functions</em> — predicates are statements about some input(s) that either hold or don't hold. <a href="https://stackoverflow.com/questions/23282097/prolog-program-to-check-if-a-number-is-prime">One way</a> of testing primality in Prolog can be achieved via the following:</p>
<div class="highlight"><pre><span></span><span class="c1">%% is_prime(+N)</span>
<span class="c1">%</span>
<span class="c1">% Holds if N is a prime.</span>

<span class="nf">is_prime</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="p">:-</span> <span class="p">!.</span>
<span class="nf">is_prime</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="p">:-</span> <span class="p">!.</span>

<span class="nf">is_prime</span><span class="p">(</span><span class="nv">N</span><span class="p">)</span> <span class="p">:-</span>
  <span class="nv">N</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">,</span>
  <span class="nv">N</span> <span class="o">mod</span> <span class="mi">2</span> <span class="s s-Atom">=\=</span> <span class="mi">0</span><span class="p">,</span>
  <span class="nf">is_prime</span><span class="p">(</span><span class="nv">N</span><span class="p">,</span> <span class="mi">3</span><span class="p">).</span>
<span class="nf">is_prime</span><span class="p">(</span><span class="nv">N</span><span class="p">,</span> <span class="nv">X</span><span class="p">)</span> <span class="p">:-</span>
  <span class="p">(</span> <span class="nv">X</span><span class="o">*</span><span class="nv">X</span> <span class="o">&gt;</span> <span class="nv">N</span> <span class="s s-Atom">-&gt;</span>
    <span class="s s-Atom">true</span>
  <span class="p">;</span> <span class="nv">N</span> <span class="o">mod</span> <span class="nv">X</span> <span class="s s-Atom">=\=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="nv">M</span> <span class="o">is</span> <span class="nv">X</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span>
    <span class="nf">is_prime</span><span class="p">(</span><span class="nv">N</span><span class="p">,</span> <span class="nv">M</span><span class="p">)</span>
  <span class="p">).</span>
</pre></div>
<p>And while the goal of this post is to demonstrate Prolog — not teach it — I recognize some background is still necessary, so the following will hopefully serve as a whirlwind tour of Prolog:</p>
<p>Firstly, there are two main ways of interfacing with Prolog: facts/rules, and queries. <em>Facts</em> and <em>rules</em> determine what can be queried, and they define expressions either declaratively or implicitly, respectively. For example, <code>married(bob, john).</code> is a fact declaring Bob to be married to John. An example of a rule could be <code>is_single(Person) :- not(married(Person, _) ; married(_, Person)).</code> which says that a person is single if they are not married to someone else (we need to account for both positions/relations in the <code>married</code> fact). Similar to a wildcard, the underscore indicates any person (we assume people cannot marry themselves).</p>
<p>Predicates are defined with the syntax <code>head :- body.</code> which reads as "the predicate <code>head</code> holds if <code>body</code> holds." And the body of a predicate consists of clauses linked by conjunctions ("and"s with a comma <code>,</code>), disjunctions ("or"s with a semicolon <code>;</code>), and are ended with a period <code>.</code>. Variables begin with uppercase letters, and constants (called <em>atoms</em>) begin with a lowercase. When we write <code>is_prime(2) :- !.</code> in the above code, we assert <code>is_prime</code> holds for the number two (or, that the number 2 is prime). The <code>!</code> (called a <em>cut</em>) makes this subtly different, but we'll get to that shortly.</p>
<p><em>Querying</em> in Prolog lets you interact with the "database" you've built from facts and rules/predicates. For example, if we query</p>
<div class="highlight"><pre><span></span><span class="s s-Atom">?-</span> <span class="nf">is_single</span><span class="p">(</span><span class="s s-Atom">john</span><span class="p">).</span>
<span class="s s-Atom">false</span><span class="p">.</span>
</pre></div>
<p>we see that John is not single — i.e., he is married to someone. Now, let's say we want to find out who is married to whom. Since we know John isn't single, let's write a query for his spouse:</p>
<div class="highlight"><pre><span></span><span class="s s-Atom">?-</span> <span class="nf">married</span><span class="p">(</span><span class="s s-Atom">john</span><span class="p">,</span> <span class="nv">Person</span><span class="p">)</span> <span class="p">;</span> <span class="nf">married</span><span class="p">(</span><span class="nv">Person</span><span class="p">,</span> <span class="s s-Atom">john</span><span class="p">).</span>
<span class="nv">Person</span> <span class="o">=</span> <span class="s s-Atom">bob</span><span class="p">.</span>
</pre></div>
<p><code>Person</code> in the query is a variable (indicated by its uppercase starting character). Prolog shows us what <code>Person</code> was <em>bound</em> to in order to satisfy the query — in other words, if you "plug in" the result from Prolog, your query will evalute to true. You can think of it like Prolog saying: "here's what needs to be true for the query to hold." Note that here we have to write the <code>married/2</code> relation twice to account for <code>john</code> being in either position in <code>married/2</code>.</p>
<p>If there are multiple ways to satisfy a query, Prolog will enumerate all possibilities. We can demonstrate this by adding another partner for John with the fact <code>married(john, sam).</code>:</p>
<div class="highlight"><pre><span></span><span class="s s-Atom">?-</span> <span class="nf">married</span><span class="p">(</span><span class="s s-Atom">john</span><span class="p">,</span> <span class="nv">P</span><span class="p">)</span> <span class="p">;</span> <span class="nf">married</span><span class="p">(</span><span class="nv">P</span><span class="p">,</span> <span class="s s-Atom">john</span><span class="p">).</span>
<span class="nv">P</span> <span class="o">=</span> <span class="s s-Atom">sam</span> <span class="p">;</span>
<span class="nv">P</span> <span class="o">=</span> <span class="s s-Atom">bob</span><span class="p">.</span>
</pre></div>
<p>This is a good time to mention that Prolog's inference engine features <em>backtracking</em>, which means it will generate multiple pathways for an execution to follow, pursue one, and then follow up on any paths that could satisfy the query later. In the above query, pressing <code>;</code> will search for further satisfying bindings, and <code>.</code> will terminate the search.</p>
<p>Hopefully this brief primer gives you some intuition for the primality test code above. Some additional useful syntax to know is that <code>( X -&gt; Y ; Z )</code> is an if-then-else block (<code>if X then Y else Z</code>), and predicates can share names as long as they have different <em>arity</em> (number of predicate arguments), which is typically written after the predicate name with a forward slash, e.g. <code>is_prime/1</code> and <code>is_prime/2</code>.</p>
<h3 id="Translating-satisfiable-conditions">Translating satisfiable conditions<a class="anchor-link" href="#Translating-satisfiable-conditions">&#182;</a></h3><p>Now that we can test for prime numbers, we need a predicate to determine whether the sum and difference of two numbers are prime:</p>
<div class="highlight"><pre><span></span><span class="c1">%% prime_sumdiff(+N, +M)</span>
<span class="c1">%</span>
<span class="c1">% Holds if the sum and difference of N and M are both primes.</span>

<span class="nf">prime_sumdiff</span><span class="p">(</span><span class="nv">N</span><span class="p">,</span> <span class="nv">M</span><span class="p">)</span> <span class="p">:-</span>
  <span class="nv">Sum</span> <span class="o">is</span> <span class="nv">N</span> <span class="o">+</span> <span class="nv">M</span><span class="p">,</span>
  <span class="nv">Diff</span> <span class="o">is</span> <span class="nf">abs</span><span class="p">(</span><span class="nv">N</span> <span class="o">-</span> <span class="nv">M</span><span class="p">),</span>
  <span class="nf">is_prime</span><span class="p">(</span><span class="nv">Sum</span><span class="p">),</span>
  <span class="nf">is_prime</span><span class="p">(</span><span class="nv">Diff</span><span class="p">).</span>
</pre></div>
<p>This one is pretty simple: it takes two numbers <code>N</code> and <code>M</code>, computes their sum and difference (in Prolog, <code>is</code> evaluates an expression), and only holds if both are prime.</p>
<p>Next, to iteratively place our numbers in a circle, we can represent positions as a list, placing numbers left-to-right and ensuring that the last and first numbers also meet the prime sum-difference condition. While there are many ways to approach this, here's a recursive definition of the problem:</p>
<ul>
<li><strong>Base case</strong>: all numbers have been placed correctly except for the last one, which must "fit" with $x_{n-2}$ and $x_0$ (the penultimate and first numbers)</li>
<li><strong>Recursive case</strong>: we must place some number $x_i$ next to the previous number $x_{i-1}$ while satisfying the prime sum-difference condition, and then place any remaining numbers</li>
</ul>
<p>We can translate this into a predicate <code>place_adjacents/3</code>, starting with the base case:</p>
<div class="highlight"><pre><span></span><span class="c1">%% place_adjacents(+Nums, -Placements, +Acc)</span>
<span class="c1">%</span>
<span class="c1">% Places each number in a list Nums into a circular list Placements in which</span>
<span class="c1">% each pair satisfies the prime sum-difference condition.</span>

<span class="c1">% base case</span>
<span class="nf">place_adjacents</span><span class="p">([</span><span class="nv">N</span><span class="p">],</span> <span class="nv">Placements</span><span class="p">,</span> <span class="p">[</span><span class="nv">First</span><span class="p">|</span><span class="nv">Acc</span><span class="p">])</span> <span class="p">:-</span>
  <span class="nf">last</span><span class="p">(</span><span class="nv">Acc</span><span class="p">,</span> <span class="nv">Last</span><span class="p">),</span> <span class="c1">% need to place the last number</span>
  <span class="nf">prime_sumdiff</span><span class="p">(</span><span class="nv">Last</span><span class="p">,</span> <span class="nv">N</span><span class="p">),</span>
  <span class="nf">prime_sumdiff</span><span class="p">(</span><span class="nv">N</span><span class="p">,</span> <span class="nv">First</span><span class="p">),</span>
  <span class="nf">append</span><span class="p">([</span><span class="nv">First</span><span class="p">|</span><span class="nv">Acc</span><span class="p">],</span> <span class="p">[</span><span class="nv">N</span><span class="p">],</span> <span class="nv">Placements</span><span class="p">).</span>
</pre></div>
<p>At a high level, this predicate takes the last number of our list of numbers to place, and ensures it meets the prime sum-difference condition with the first and last elements of the list-so-far before appending the number to the list-so-far, yielding the solution.</p>
<p>We can use Prolog's pattern matching to indicate that this predicate is only applicable when the first argument is a singleton list (with the last number <code>N</code> to place), meaning the predicate will only ever be used during the base case. <code>Placements</code> is the final placement list, and <code>[First|Acc]</code> is the list of digits so far with <code>First</code> being the first element (head) of the list and <code>Acc</code> the rest (tail) (in Prolog, the pipe character <code>|</code> is the construct operator).</p>
<p>We can similarly model the recursive case as:</p>
<div class="highlight"><pre><span></span><span class="c1">% recursive case</span>
<span class="nf">place_adjacents</span><span class="p">(</span><span class="nv">Nums</span><span class="p">,</span> <span class="nv">Placements</span><span class="p">,</span> <span class="nv">Acc</span><span class="p">)</span> <span class="p">:-</span>
  <span class="nf">select</span><span class="p">(</span><span class="nv">N</span><span class="p">,</span> <span class="nv">Nums</span><span class="p">,</span> <span class="nv">Nums1</span><span class="p">),</span> <span class="c1">% select the number to place</span>
  <span class="nf">last</span><span class="p">(</span><span class="nv">Acc</span><span class="p">,</span> <span class="nv">Last</span><span class="p">),</span>
  <span class="nf">prime_sumdiff</span><span class="p">(</span><span class="nv">Last</span><span class="p">,</span> <span class="nv">N</span><span class="p">),</span>
  <span class="nf">append</span><span class="p">(</span><span class="nv">Acc</span><span class="p">,</span> <span class="p">[</span><span class="nv">N</span><span class="p">],</span> <span class="nv">Acc1</span><span class="p">),</span>
  <span class="nf">place_adjacents</span><span class="p">(</span><span class="nv">Nums1</span><span class="p">,</span> <span class="nv">Placements</span><span class="p">,</span> <span class="nv">Acc1</span><span class="p">).</span>
</pre></div>
<p>Which uses the built-in <code>select/3</code> predicate to retrieve $x_i$ (<code>N</code>) from the available numbers <code>Nums</code>, leaving us with one less number in <code>Nums1</code>. Then, we compare $x_{i}$ with $x_{i-1}$ and add it to our list if it's compatible. To place the remaining digits, we recurse. Note that <code>select/3</code> is used because it is "nondeterministic" and selects <em>any</em> number from our list of numbers to place.</p>
<h3 id="Bringing-it-all-together">Bringing it all together<a class="anchor-link" href="#Bringing-it-all-together">&#182;</a></h3><p>With the bulk of the solver done, we need to "glue" our predicates together to create a simple interface. One implementation quirk we need to be careful of is that $x_{i-1}$ always exists in the recursive case (i.e. the accumulated list is never empty), so we need to ensure our main predicate begins with a number in the list (keeping in mind that it doesn't matter which number we start with, since a circular list has no "start" or "end").</p>
<div class="highlight"><pre><span></span><span class="c1">%% circular_primes(+Low, +High, -Placements)</span>
<span class="c1">%</span>
<span class="c1">% Pairs numbers in a range [Low, High] such that the sums and differences of</span>
<span class="c1">% adjacent pairs of numbers in a circular list Placements are primes.</span>

<span class="nf">circular_primes</span><span class="p">(</span><span class="nv">Low</span><span class="p">,</span> <span class="nv">High</span><span class="p">,</span> <span class="nv">Placements</span><span class="p">)</span> <span class="p">:-</span>
  <span class="nv">Low</span> <span class="o">&lt;</span> <span class="nv">High</span><span class="p">,</span>
  <span class="nf">bagof</span><span class="p">(</span><span class="nv">N</span><span class="p">,</span> <span class="nf">between</span><span class="p">(</span><span class="nv">Low</span><span class="p">,</span> <span class="nv">High</span><span class="p">,</span> <span class="nv">N</span><span class="p">),</span> <span class="nv">Nums</span><span class="p">),</span>
  <span class="nf">select</span><span class="p">(</span><span class="nv">First</span><span class="p">,</span> <span class="nv">Nums</span><span class="p">,</span> <span class="nv">NewNums</span><span class="p">),</span> <span class="c1">% select the first candidate number</span>
  <span class="nf">place_adjacents</span><span class="p">(</span><span class="nv">NewNums</span><span class="p">,</span> <span class="nv">Placements</span><span class="p">,</span> <span class="p">[</span><span class="nv">First</span><span class="p">]).</span>
</pre></div>
<p>This predicate accepts a valid lower and upper bound such that $\forall i:x_i\in\left[\verb|Low|,\verb|High|\right]$. Here, <code>bagof</code> is used to take all unique <code>N</code> such that <code>N</code> is between <code>Low</code> and <code>High</code>, storing the list in <code>Nums</code> (this specific usage of <code>bagof</code> is similar to Python's <code>range()</code> function). We also initialize the placement list with <code>First</code>, and state that in order for <code>circular_primes/3</code> to hold, we must be able to place the remaining numbers <code>NewNums</code> as well.</p>
<p>And that's it! All that's left is to enter query mode and ask Prolog:</p>
<div class="highlight"><pre><span></span><span class="s s-Atom">?-</span> <span class="nf">circular_primes</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="nv">Ps</span><span class="p">).</span>
<span class="nv">Ps</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">12</span><span class="p">]</span> <span class="p">.</span>
</pre></div>
<p>With the numbers 1–14, the predicate succeeds with the above placement specification. If we ask Prolog to keep generating solutions, we yield all of the different "rotations" or "shifts" (and reflections) of the circular list (for this example, there is only one unique solution):</p>
<div class="highlight"><pre><span></span><span class="s s-Atom">?-</span> <span class="nf">circular_primes</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="nv">Ps</span><span class="p">).</span>
<span class="nv">Ps</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">12</span><span class="p">]</span> <span class="p">;</span>
<span class="nv">Ps</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span> <span class="p">;</span>
<span class="nv">Ps</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">9</span><span class="p">]</span> <span class="p">;</span>
<span class="nv">Ps</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span> <span class="p">;</span>
<span class="nv">Ps</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">14</span><span class="p">]</span> <span class="p">.</span>
</pre></div>
<p>And the best part is, since we've written a general solver for this type of question, we can ask Prolog for solutions for any range of numbers:</p>
<div class="highlight"><pre><span></span><span class="s s-Atom">?-</span> <span class="nf">circular_primes</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="nv">Ps</span><span class="p">).</span> <span class="c1">% this has no solution</span>
<span class="s s-Atom">false</span><span class="p">.</span>

<span class="s s-Atom">?-</span> <span class="nf">circular_primes</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="nv">Ps</span><span class="p">).</span>
<span class="nv">Ps</span> <span class="o">=</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">17</span><span class="p">]</span> <span class="p">.</span>
</pre></div>
<h3 id="A-technical-note-on-implementation">A technical note on implementation<a class="anchor-link" href="#A-technical-note-on-implementation">&#182;</a></h3><p>Before continuing, a brief note on alternative approaches — feel free to <a href="#Futoshiki">skip this part</a>.</p>
<p>A natural question for a Prolog programmer at this point may be "Why not use CLP(FD)?" After all, this problem can (very easily) be described in the following two predicates:</p>
<ol>
<li>$\forall i \forall j : x_i,x_j\in\left[1,14\right]\wedge x_i\ne x_j$</li>
<li>$\forall i : \text{Prime}\left(x_i+x_{(i+1)\bmod 15}\right)\wedge\text{Prime}\left(\left|x_i-x_{(i+1)\bmod 15}\right|\right)$</li>
</ol>
<p>so why would would CLP(FD) not be the right approach?</p>
<p>The answer is: because of primality tests. Testing for primality is trivial when a variable is ground (e.g. in the above code), but primality is <em>difficult</em> to express as a constraint. <a href="https://stackoverflow.com/questions/39591888/clpfd-constraint-is-a-prime-number">This thread</a> is the only working solution I've been able to find for a primality constraint, but the complexity is far beyond my level.</p>
<p>I was able to get a version using CLP(FD) working, but the performance is awful (I suspect due to the primality constraint). It's a shame, because the rest of the solution is extremely idiomatic:</p>
<div class="highlight"><pre><span></span><span class="c1">%% place_clpfd(+Low, +High, -Placements)</span>
<span class="c1">%</span>
<span class="c1">% Pairs numbers in a range [Low, High] such that the sums and differences of</span>
<span class="c1">% adjacent pairs of numbers in a circular list Placements are primes.</span>

<span class="nf">place_clpfd</span><span class="p">(</span><span class="nv">Low</span><span class="p">,</span> <span class="nv">High</span><span class="p">,</span> <span class="nv">Placements</span><span class="p">)</span> <span class="p">:-</span>
  <span class="c1">% predicate 1 - variables in range and unique</span>
  <span class="nv">Len</span> <span class="s s-Atom">#=</span> <span class="p">(</span><span class="nv">High</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="nv">Low</span><span class="p">,</span> <span class="nv">Len</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span>
  <span class="nf">length</span><span class="p">(</span><span class="nv">Placements</span><span class="p">,</span> <span class="nv">Len</span><span class="p">),</span>
  <span class="nv">Placements</span> <span class="s s-Atom">ins</span> <span class="nv">Low</span><span class="p">..</span><span class="nv">High</span><span class="p">,</span>
  <span class="nf">all_distinct</span><span class="p">(</span><span class="nv">Placements</span><span class="p">),</span>

  <span class="c1">% predicate 2 - sum-difference property</span>
  <span class="nf">sumdiff_clpfd</span><span class="p">(</span><span class="nv">Placements</span><span class="p">),</span> <span class="c1">% for adjacent numbers</span>
  <span class="nv">Placements</span> <span class="o">=</span> <span class="p">[</span><span class="nv">H</span> <span class="p">|</span> <span class="k">_</span><span class="p">],</span>
  <span class="nf">last</span><span class="p">(</span><span class="nv">Placements</span><span class="p">,</span> <span class="nv">Last</span><span class="p">),</span>
  <span class="nf">sumdiff_clpfd</span><span class="p">([</span><span class="nv">H</span><span class="p">,</span> <span class="nv">Last</span><span class="p">]),</span>  <span class="c1">% for first &amp; last</span>
  <span class="nf">label</span><span class="p">(</span><span class="nv">Placements</span><span class="p">).</span>

<span class="c1">%% sumdiff_clpfd(+List)</span>
<span class="c1">%</span>
<span class="c1">% Holds if the sum and differences of all adjacent numbers in List are primes.</span>

<span class="nf">sumdiff_clpfd</span><span class="p">([]).</span>
<span class="nf">sumdiff_clpfd</span><span class="p">([</span><span class="k">_</span><span class="p">]).</span>
<span class="nf">sumdiff_clpfd</span><span class="p">([</span><span class="nv">N</span><span class="p">,</span> <span class="nv">M</span> <span class="p">|</span> <span class="nv">T</span><span class="p">])</span> <span class="p">:-</span>
  <span class="nv">Sum</span> <span class="s s-Atom">#=</span> <span class="nv">N</span> <span class="o">+</span> <span class="nv">M</span><span class="p">,</span>
  <span class="nv">Diff</span> <span class="s s-Atom">#=</span> <span class="nf">abs</span><span class="p">(</span><span class="nv">N</span> <span class="o">-</span> <span class="nv">M</span><span class="p">),</span>
  <span class="nf">prime</span><span class="p">(</span><span class="nv">Sum</span><span class="p">),</span>
  <span class="nf">prime</span><span class="p">(</span><span class="nv">Diff</span><span class="p">),</span>
  <span class="nf">sumdiff_clpfd</span><span class="p">([</span><span class="nv">M</span> <span class="p">|</span> <span class="nv">T</span><span class="p">]).</span>
</pre></div>
<p>But finding the solution to the simple 1–14 puzzle yields, in comparison to the vanilla Prolog solution:</p>
<div class="highlight"><pre><span></span><span class="s s-Atom">?-</span> <span class="nf">time</span><span class="p">(</span><span class="nf">place_clpfd</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="nv">Ps</span><span class="p">)).</span>
<span class="c1">% 1,100,236 inferences, 0.053 CPU in 0.053 seconds (99% CPU, 20840171 Lips)</span>
<span class="nv">Ps</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">12</span><span class="p">]</span> <span class="p">.</span>

<span class="s s-Atom">?-</span> <span class="nf">time</span><span class="p">(</span><span class="nf">circular_primes</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="nv">Ps</span><span class="p">)).</span>
<span class="c1">% 3,673 inferences, 0.000 CPU in 0.000 seconds (97% CPU, 17743961 Lips)</span>
<span class="nv">Ps</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">12</span><span class="p">]</span> <span class="p">.</span>
</pre></div>
<p>...yep. The accumulator solution above (which I'm <em>confident</em> is inefficient) uses ~300x less inferences than the CLP(FD) one. It's possible a more efficient primality constraint exists out there, or it's possible I'm doing something totally wrong — either way, if you have any information surrounding this, please let me know!</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Futoshiki">Futoshiki<a class="anchor-link" href="#Futoshiki">&#182;</a></h2><p><a href="https://en.wikipedia.org/wiki/Futoshiki">Futoshiki</a> (不等式) is a logic puzzle game about inequalities. Each puzzle grid is a $n\times n$ board with optional starting numbers, and given inequality symbols ($&lt;$ and $&gt;$). A solved puzzle is a <a href="https://en.wikipedia.org/wiki/Latin_square">Latin square</a> where the digits $1$ to $n$ appear exactly once in each column and row, similar to Sudoku. The twist is that digits within cells must also satisfy any surrounding inequalities. Refer to the image below for an example:</p>
<figure class="styled"><img class="styled" src="/images/futo-example.png" width="300" height="300" title="A solved 5x5 Futoshiki board." alt="A solved 5x5 Futoshiki board."><figcaption>A solved 5x5 Futoshiki board. The emboldened numbers are supplied to begin.</figcaption></figure><p>Futoshiki is a fantastic game because it requires chains of deductive inference (e.g. "this square can't be X because cell Y has to be larger than cell Z") — I fully encourage you to <a href="https://www.brainbashers.com/futoshiki.asp">try a few games</a>.</p>
<p>From an objective point of view, though, Futoshiki is just another constraint satisfaction problem: we want to slot the numbers $1$–$n$ in unique board positions such that the Latin square property holds and all inequalities are satisfied. Since we can define the game in terms of properties that <em>should be true in a solved state</em>, we can try implementing a solver in Prolog!</p>
<h3 id="Representing-the-game-board">Representing the game board<a class="anchor-link" href="#Representing-the-game-board">&#182;</a></h3><p>For the $n\times n$ grid, we'll use the standard approach of nested arrays — but we still need a way to represent inequalities on the board with respect to different squares. One way of doing this is to specify an array of <code>(row, col)</code> pairs and describe the relationship between them. In the above example board, we can represent the inequality on the fourth row as <code>(4,4)&lt;(4,5)</code> if we use one-based indexing and define <code>(1,1)</code> to be the top-left cell.</p>
<p>To use this approach, we'll first have to tell Prolog that we're reserving the <code>&lt;</code> and <code>&gt;</code> characters for our own purposes (as part of a grammar representing an inequality):</p>
<div class="highlight"><pre><span></span><span class="p">:-</span> <span class="nf">op</span><span class="p">(</span><span class="mi">650</span><span class="p">,</span> <span class="s s-Atom">xfy</span><span class="p">,</span> <span class="s s-Atom">&lt;</span><span class="p">).</span>
<span class="p">:-</span> <span class="nf">op</span><span class="p">(</span><span class="mi">650</span><span class="p">,</span> <span class="s s-Atom">xfy</span><span class="p">,</span> <span class="s s-Atom">&gt;</span><span class="p">).</span>
</pre></div>
<p>Which just overrides Prolog's default behavior of <code>&lt;</code> and <code>&gt;</code>. Now, we'll define a predicate to tell us whether or not an inequality in our format holds:</p>
<div class="highlight"><pre><span></span><span class="c1">%% constraint_holds(+Grid, +Constraint)</span>
<span class="c1">%</span>
<span class="c1">% Holds if Constraint, indicated by (Row1,Col1)&lt;|&gt;(Row2,Col2), is true</span>
<span class="c1">% within the Grid.</span>

<span class="nf">constraint_holds</span><span class="p">(</span><span class="nv">Grid</span><span class="p">,</span> <span class="p">(</span><span class="nv">R1</span><span class="p">,</span><span class="nv">C1</span><span class="p">)</span><span class="s s-Atom">&gt;</span><span class="p">(</span><span class="nv">R2</span><span class="p">,</span><span class="nv">C2</span><span class="p">))</span> <span class="p">:-</span>
  <span class="nf">nth1_matrix</span><span class="p">(</span><span class="nv">R1</span><span class="p">,</span> <span class="nv">C1</span><span class="p">,</span> <span class="nv">Grid</span><span class="p">,</span> <span class="nv">Elem1</span><span class="p">),</span>
  <span class="nf">nth1_matrix</span><span class="p">(</span><span class="nv">R2</span><span class="p">,</span> <span class="nv">C2</span><span class="p">,</span> <span class="nv">Grid</span><span class="p">,</span> <span class="nv">Elem2</span><span class="p">),</span>
  <span class="nv">Elem1</span> <span class="s s-Atom">#&gt;</span> <span class="nv">Elem2</span><span class="p">.</span>
<span class="nf">constraint_holds</span><span class="p">(</span><span class="nv">Grid</span><span class="p">,</span> <span class="p">(</span><span class="nv">R1</span><span class="p">,</span><span class="nv">C1</span><span class="p">)</span><span class="s s-Atom">&lt;</span><span class="p">(</span><span class="nv">R2</span><span class="p">,</span><span class="nv">C2</span><span class="p">))</span> <span class="p">:-</span>
  <span class="nf">nth1_matrix</span><span class="p">(</span><span class="nv">R1</span><span class="p">,</span> <span class="nv">C1</span><span class="p">,</span> <span class="nv">Grid</span><span class="p">,</span> <span class="nv">Elem1</span><span class="p">),</span>
  <span class="nf">nth1_matrix</span><span class="p">(</span><span class="nv">R2</span><span class="p">,</span> <span class="nv">C2</span><span class="p">,</span> <span class="nv">Grid</span><span class="p">,</span> <span class="nv">Elem2</span><span class="p">),</span>
  <span class="nv">Elem1</span> <span class="s s-Atom">#&lt;</span> <span class="nv">Elem2</span><span class="p">.</span>
</pre></div>
<p>These two predicates do the same thing, but using <code>&lt;</code> and <code>&gt;</code> means we need to specify pattern matches for both symbols (as far as I can tell — if you know a way around this, please reach out). In both predicates, we're simply navigating to <code>Grid[R1][C1]</code> and asserting it is strictly less than or greater than <code>Grid[R2][C2]</code>, accordingly.</p>
<p>This <code>nth1_matrix/4</code> is a helper-predicate to access a 2D array, and can be defined as follows:</p>
<div class="highlight"><pre><span></span><span class="c1">%% nth1_matrix(?Row, ?Col, +Matrix, ?Elem)</span>
<span class="c1">%</span>
<span class="c1">% Way to access Row-th row and Col-th column of Matrix. Holds if</span>
<span class="c1">% Matrix[Row][Col] is Elem.</span>

<span class="nf">nth1_matrix</span><span class="p">(</span><span class="nv">Row</span><span class="p">,</span> <span class="nv">Col</span><span class="p">,</span> <span class="nv">Matrix</span><span class="p">,</span> <span class="nv">Elem</span><span class="p">)</span> <span class="p">:-</span>
  <span class="nf">nth1</span><span class="p">(</span><span class="nv">Row</span><span class="p">,</span> <span class="nv">Matrix</span><span class="p">,</span> <span class="nv">MatRow</span><span class="p">),</span>
  <span class="nf">nth1</span><span class="p">(</span><span class="nv">Col</span><span class="p">,</span> <span class="nv">MatRow</span><span class="p">,</span> <span class="nv">Elem</span><span class="p">).</span>
</pre></div>
<h3 id="Prolog-arithmetic">Prolog arithmetic<a class="anchor-link" href="#Prolog-arithmetic">&#182;</a></h3><p>You may have picked up on the weird <code>#&lt;</code> and <code>#&gt;</code> operators in <code>constraint_holds/2</code>. Explaining this requires some understanding of math in Prolog: in Prolog, arithmetic is fairly straight forward: let's say we want to check the parity of the integer <code>X</code>:</p>
<div class="highlight"><pre><span></span><span class="s s-Atom">?-</span> <span class="nv">X</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="nv">X</span> <span class="o">mod</span> <span class="mi">2</span> <span class="o">=:=</span> <span class="mf">0.</span>
<span class="nv">X</span> <span class="o">=</span> <span class="mf">10.</span>
</pre></div>
<p>We simply set <code>X</code> to <code>10</code> and check if $x \bmod 2$ is zero, using <code>=:=</code> for evaluated expression equality. Numerical constraints, on the other hand, are not so straight forward: doing any comparison on arithmetic-bound variables requires those variables to be instantiated. For example, if we wanted to find every even integer between zero and ten:</p>
<div class="highlight"><pre><span></span><span class="s s-Atom">?-</span> <span class="nv">X</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="nv">X</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">,</span> <span class="nv">X</span> <span class="o">mod</span> <span class="mi">2</span> <span class="o">=:=</span> <span class="mf">0.</span>
<span class="nv">ERROR</span><span class="s s-Atom">:</span> <span class="nv">Arguments</span> <span class="s s-Atom">are</span> <span class="o">not</span> <span class="s s-Atom">sufficiently</span> <span class="s s-Atom">instantiated</span>
<span class="nv">ERROR</span><span class="s s-Atom">:</span> <span class="p">...</span>
</pre></div>
<p>While you might expect this to yield 2, 4, and so on, we instead get an error. This is because in order to evaluate <code>X mod 2</code>, <code>X</code> needs to be bound, but we don't know the exact value of <code>X</code> when we need to instantiate it — so we get a sort of circular problem. To circumvent this, we can use the <a href="https://www.swi-prolog.org/man/clpfd.html">CLP(FD) library</a> for numeric constraints by including it in our file:</p>
<div class="highlight"><pre><span></span><span class="p">:-</span> <span class="nf">use_module</span><span class="p">(</span><span class="nf">library</span><span class="p">(</span><span class="s s-Atom">clpfd</span><span class="p">)).</span>
</pre></div>
<p>Which defines the operators <code>#=</code>, <code>#&lt;</code>, <code>#&gt;</code>, and so on for constraint definitions. Then, we can retry our original query using the new operators:</p>
<div class="highlight"><pre><span></span><span class="s s-Atom">?-</span> <span class="nv">X</span> <span class="s s-Atom">#&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="nv">X</span> <span class="s s-Atom">#&lt;</span> <span class="mi">10</span><span class="p">,</span> <span class="nv">X</span> <span class="o">mod</span> <span class="mi">2</span> <span class="s s-Atom">#=</span> <span class="mf">0.</span>
<span class="nv">X</span> <span class="s s-Atom">in</span> <span class="mf">2..8</span><span class="p">,</span>
<span class="nv">X</span> <span class="o">mod</span> <span class="mi">2</span><span class="s s-Atom">#=</span><span class="mf">0.</span>
</pre></div>
<p>This may look strange, but this is CLP(FD) at work — to turn this expression into bound variables, we have to <code>label/1</code> the data:</p>
<div class="highlight"><pre><span></span><span class="s s-Atom">?-</span> <span class="nv">X</span> <span class="s s-Atom">#&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="nv">X</span> <span class="s s-Atom">#&lt;</span> <span class="mi">10</span><span class="p">,</span> <span class="nv">X</span> <span class="o">mod</span> <span class="mi">2</span> <span class="s s-Atom">#=</span> <span class="mi">0</span><span class="p">,</span> <span class="nf">label</span><span class="p">([</span><span class="nv">X</span><span class="p">]).</span>
<span class="nv">X</span> <span class="o">=</span> <span class="mi">2</span> <span class="p">;</span>
<span class="nv">X</span> <span class="o">=</span> <span class="mi">4</span> <span class="p">;</span>
<span class="nv">X</span> <span class="o">=</span> <span class="mi">6</span> <span class="p">;</span>
<span class="nv">X</span> <span class="o">=</span> <span class="mf">8.</span>
</pre></div>
<p>This is why <code>#&lt;</code> and <code>#&gt;</code> are used in our <code>constraint_holds/2</code> predicate — because we want to put constraints on variables we don't know the values of yet. The possibilities with CLP(FD) and its accompanying CLP(Z) library are quite endless — see <a href="https://www.metalevel.at/prolog/clpz">here</a> for more.</p>
<h3 id="Solving-Futoshiki">Solving Futoshiki<a class="anchor-link" href="#Solving-Futoshiki">&#182;</a></h3><p>Although specifying inequalities in the format <code>(R1,C1)&lt;|&gt;(R2,C2)</code> works, chains of inequalities become clumsy: for example, <code>(R1,C1)&lt;(R2,C2)&lt;(R3,C3)</code> is represented by <code>[(R1,C1)&lt;(R2,C2), (R2,C2)&lt;(R3,C3)]</code>, meaning we have to duplicate the intermediary cell <code>(R2,C2)</code>.</p>
<p>We can remedy this by creating a predicate that breaks down such chains into their constituents:</p>
<div class="highlight"><pre><span></span><span class="c1">%% decompose_ineqs(+Expr, -Dec)</span>
<span class="c1">%</span>
<span class="c1">% Decomposes a string of inequalities (in the form (Row1,Col1)(&lt;|&gt;)(Row2,Col2))</span>
<span class="c1">% into a list of separate inequalities, e.g. A&lt;B&gt;C -&gt; [A&lt;B, B&gt;C].</span>

<span class="nf">decompose_ineqs</span><span class="p">(</span><span class="nv">Expr</span><span class="p">,</span> <span class="nv">Dec</span><span class="p">)</span> <span class="p">:-</span> <span class="nf">decompose_ineqs</span><span class="p">(</span><span class="nv">Expr</span><span class="p">,</span> <span class="p">[],</span> <span class="nv">Dec</span><span class="p">).</span>
<span class="nf">decompose_ineqs</span><span class="p">(</span><span class="nv">Expr</span><span class="p">,</span> <span class="nv">Acc</span><span class="p">,</span> <span class="nv">Dec</span><span class="p">)</span> <span class="p">:-</span>
  <span class="p">(</span> <span class="nv">Expr</span> <span class="o">=</span> <span class="nv">A</span><span class="o">&lt;</span><span class="nv">B</span><span class="o">&lt;</span><span class="nv">C</span> <span class="s s-Atom">-&gt;</span>
    <span class="nf">append</span><span class="p">(</span><span class="nv">Acc</span><span class="p">,</span> <span class="p">[</span><span class="nv">A</span><span class="o">&lt;</span><span class="nv">B</span><span class="p">],</span> <span class="nv">Acc1</span><span class="p">),</span>
    <span class="nf">decompose_ineqs</span><span class="p">(</span><span class="nv">B</span><span class="o">&lt;</span><span class="nv">C</span><span class="p">,</span> <span class="nv">Acc1</span><span class="p">,</span> <span class="nv">Dec</span><span class="p">)</span>
  <span class="p">;</span> <span class="nv">Expr</span> <span class="o">=</span> <span class="nv">A</span><span class="o">&gt;</span><span class="nv">B</span><span class="o">&lt;</span><span class="nv">C</span> <span class="s s-Atom">-&gt;</span>
    <span class="nf">append</span><span class="p">(</span><span class="nv">Acc</span><span class="p">,</span> <span class="p">[</span><span class="nv">A</span><span class="o">&gt;</span><span class="nv">B</span><span class="p">],</span> <span class="nv">Acc1</span><span class="p">),</span>
    <span class="nf">decompose_ineqs</span><span class="p">(</span><span class="nv">B</span><span class="o">&lt;</span><span class="nv">C</span><span class="p">,</span> <span class="nv">Acc1</span><span class="p">,</span> <span class="nv">Dec</span><span class="p">)</span>
  <span class="p">;</span> <span class="nv">Expr</span> <span class="o">=</span> <span class="nv">A</span><span class="o">&lt;</span><span class="nv">B</span><span class="o">&gt;</span><span class="nv">C</span> <span class="s s-Atom">-&gt;</span>
    <span class="nf">append</span><span class="p">(</span><span class="nv">Acc</span><span class="p">,</span> <span class="p">[</span><span class="nv">A</span><span class="o">&lt;</span><span class="nv">B</span><span class="p">],</span> <span class="nv">Acc1</span><span class="p">),</span>
    <span class="nf">decompose_ineqs</span><span class="p">(</span><span class="nv">B</span><span class="o">&gt;</span><span class="nv">C</span><span class="p">,</span> <span class="nv">Acc1</span><span class="p">,</span> <span class="nv">Dec</span><span class="p">)</span>
  <span class="p">;</span> <span class="nv">Expr</span> <span class="o">=</span> <span class="nv">A</span><span class="o">&gt;</span><span class="nv">B</span><span class="o">&gt;</span><span class="nv">C</span> <span class="s s-Atom">-&gt;</span>
    <span class="nf">append</span><span class="p">(</span><span class="nv">Acc</span><span class="p">,</span> <span class="p">[</span><span class="nv">A</span><span class="o">&gt;</span><span class="nv">B</span><span class="p">],</span> <span class="nv">Acc1</span><span class="p">),</span>
    <span class="nf">decompose_ineqs</span><span class="p">(</span><span class="nv">B</span><span class="o">&gt;</span><span class="nv">C</span><span class="p">,</span> <span class="nv">Acc1</span><span class="p">,</span> <span class="nv">Dec</span><span class="p">)</span>
  <span class="p">;</span> <span class="nv">Expr</span> <span class="o">=</span> <span class="nv">A</span><span class="o">&lt;</span><span class="nv">B</span> <span class="s s-Atom">-&gt;</span>
    <span class="nf">append</span><span class="p">(</span><span class="nv">Acc</span><span class="p">,</span> <span class="p">[</span><span class="nv">A</span><span class="o">&lt;</span><span class="nv">B</span><span class="p">],</span> <span class="nv">Dec</span><span class="p">)</span>
  <span class="p">;</span> <span class="nv">Expr</span> <span class="o">=</span> <span class="nv">A</span><span class="o">&gt;</span><span class="nv">B</span> <span class="s s-Atom">-&gt;</span>
    <span class="nf">append</span><span class="p">(</span><span class="nv">Acc</span><span class="p">,</span> <span class="p">[</span><span class="nv">A</span><span class="o">&gt;</span><span class="nv">B</span><span class="p">],</span> <span class="nv">Dec</span><span class="p">)</span>
  <span class="p">).</span>
</pre></div>
<p>This looks like it's doing a lot because of exhaustive pattern matching, but really, it's just breaking down long expressions of inequalities into pairs of expressions our <code>constraint_holds/2</code> predicate can validate. For example:</p>
<div class="highlight"><pre><span></span><span class="s s-Atom">?-</span> <span class="nf">decompose_ineqs</span><span class="p">((</span><span class="nv">R1</span><span class="p">,</span><span class="nv">C1</span><span class="p">)</span><span class="s s-Atom">&lt;</span><span class="p">(</span><span class="nv">R2</span><span class="p">,</span><span class="nv">C2</span><span class="p">)</span><span class="s s-Atom">&lt;</span><span class="p">(</span><span class="nv">R3</span><span class="p">,</span><span class="nv">C3</span><span class="p">),</span> <span class="nv">Constituents</span><span class="p">).</span>
<span class="nv">Constituents</span> <span class="o">=</span> <span class="p">[(</span><span class="nv">R1</span><span class="p">,</span> <span class="nv">C1</span><span class="p">)</span><span class="s s-Atom">&lt;</span><span class="p">(</span><span class="nv">R2</span><span class="p">,</span> <span class="nv">C2</span><span class="p">),</span> <span class="p">(</span><span class="nv">R2</span><span class="p">,</span> <span class="nv">C2</span><span class="p">)</span><span class="s s-Atom">&lt;</span><span class="p">(</span><span class="nv">R3</span><span class="p">,</span> <span class="nv">C3</span><span class="p">)].</span>
</pre></div>
<p>With this functionality, we are now in a pretty good position to solve a generic Futoshiki puzzle:</p>
<div class="highlight"><pre><span></span><span class="c1">%% solve_futoshiki(+Grid, +Constraints)</span>
<span class="c1">%</span>
<span class="c1">% Solves a Futoshiki board where the grid is a square 2D array of arrays, and</span>
<span class="c1">% constraints to satisfy are supplied as an array.</span>

<span class="nf">solve_futoshiki</span><span class="p">(</span><span class="nv">Grid</span><span class="p">,</span> <span class="nv">Constraints</span><span class="p">)</span> <span class="p">:-</span>
  <span class="c1">% constraint 1 - Latin square</span>
  <span class="nf">length</span><span class="p">(</span><span class="nv">Grid</span><span class="p">,</span> <span class="nv">Rows</span><span class="p">),</span> <span class="nf">maplist</span><span class="p">(</span><span class="nf">same_length</span><span class="p">(</span><span class="nv">Grid</span><span class="p">),</span> <span class="nv">Grid</span><span class="p">),</span> <span class="c1">% square grid</span>
  <span class="nf">append</span><span class="p">(</span><span class="nv">Grid</span><span class="p">,</span> <span class="nv">Values</span><span class="p">),</span> <span class="nv">Values</span> <span class="s s-Atom">ins</span> <span class="mf">1.</span><span class="p">.</span><span class="nv">Rows</span><span class="p">,</span> <span class="c1">% all values between [1,n]</span>
  <span class="nf">maplist</span><span class="p">(</span><span class="s s-Atom">all_distinct</span><span class="p">,</span> <span class="nv">Grid</span><span class="p">),</span> <span class="c1">% rows all different</span>

  <span class="c1">% cols</span>
  <span class="nf">transpose</span><span class="p">(</span><span class="nv">Grid</span><span class="p">,</span> <span class="nv">Cols</span><span class="p">),</span>
  <span class="nf">maplist</span><span class="p">(</span><span class="s s-Atom">all_distinct</span><span class="p">,</span> <span class="nv">Cols</span><span class="p">),</span> <span class="c1">% cols all different</span>

  <span class="c1">% Constraint 2 - inequalities are satisfied</span>
  <span class="nf">maplist</span><span class="p">(</span><span class="s s-Atom">decompose_ineqs</span><span class="p">,</span> <span class="nv">Constraints</span><span class="p">,</span> <span class="nv">IneqsList</span><span class="p">),</span>
  <span class="nf">append</span><span class="p">(</span><span class="nv">IneqsList</span><span class="p">,</span> <span class="nv">Ineqs</span><span class="p">),</span>
  <span class="nf">maplist</span><span class="p">(</span><span class="nf">constraint_holds</span><span class="p">(</span><span class="nv">Grid</span><span class="p">),</span> <span class="nv">Ineqs</span><span class="p">),</span>
  <span class="nf">maplist</span><span class="p">(</span><span class="s s-Atom">label</span><span class="p">,</span> <span class="nv">Grid</span><span class="p">).</span>
</pre></div>
<p>First, we ensure the Latin square properties hold: (1) the grid is square (the number of columns are equal to the number of rows); (2) the values in the grid all fall within $[1,n]$; and (3) each number appears in each row and column exactly once (we use CLP(FD)'s <code>all_distinct/2</code> to ensure all rows/cols are different).</p>
<p>The inequalities in the grid can be validated by (1) decomposing all supplied inequalities and creating a single inequality list; and (2) mapping over this list and ensuring all constraints hold in the grid. And that's it! Relatively straightforward when defined at a high-level like this, so let's try it out on some puzzles.</p>
<h3 id="Testing-the-solution">Testing the solution<a class="anchor-link" href="#Testing-the-solution">&#182;</a></h3><p>We'll start with an easy 4x4:</p>
<figure class="styled"><img src="/images/futo-combined-1.png" width="500" height="250" title="An example 4x4 puzzle." alt="An example 4x4 puzzle."><figcaption>An example 4x4 puzzle. Initial configuration (left) and solution (right).</figcaption></figure><p>For our predicate, we represent empty cells with unbound logic variables in a $4\times4$ nested array (with 2 and 4 supplied). We also supply the two chains of inequalities like so:</p>
<div class="highlight"><pre><span></span><span class="nf">test</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">:-</span>
  <span class="nv">Grid</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="k">_</span><span class="p">,</span> <span class="k">_</span><span class="p">,</span> <span class="k">_</span><span class="p">,</span> <span class="k">_</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="k">_</span><span class="p">,</span> <span class="k">_</span><span class="p">,</span> <span class="k">_</span><span class="p">],</span>
    <span class="p">[</span><span class="k">_</span><span class="p">,</span> <span class="k">_</span><span class="p">,</span> <span class="k">_</span><span class="p">,</span> <span class="k">_</span><span class="p">],</span>
    <span class="p">[</span><span class="k">_</span><span class="p">,</span> <span class="k">_</span><span class="p">,</span> <span class="k">_</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
  <span class="p">],</span>
  <span class="nv">Constraints</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="s s-Atom">&gt;</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="s s-Atom">&gt;</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="s s-Atom">&lt;</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span>
    <span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="s s-Atom">&gt;</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
  <span class="p">],</span>
  <span class="nf">solve_futoshiki</span><span class="p">(</span><span class="nv">Grid</span><span class="p">,</span> <span class="nv">Constraints</span><span class="p">),</span>
  <span class="nf">write</span><span class="p">(</span><span class="nv">Grid</span><span class="p">).</span>
</pre></div>
<p>And query the result via:</p>
<div class="highlight"><pre><span></span><span class="s s-Atom">?-</span> <span class="nf">test</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span>
<span class="p">[[</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">]]</span>
<span class="s s-Atom">true</span> <span class="p">.</span>
</pre></div>
<p>Here's another example with a more difficult 7x7:</p>
<figure class="styled"><img src="/images/futo-combined-2.png" width="500" height="250" title="An example 7x7 puzzle." alt="An example 7x7 puzzle."><figcaption>An example 7x7 puzzle. Initial configuration (left) and solution (right).</figcaption></figure><p>A 7x7 grid is annoying to type, so here I just implicitly define the grid and instead set given digits with our indexing predicate:</p>
<div class="highlight"><pre><span></span><span class="nf">test</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="p">:-</span>
  <span class="nf">length</span><span class="p">(</span><span class="nv">Grid</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span>
  <span class="nf">maplist</span><span class="p">(</span><span class="nf">same_length</span><span class="p">(</span><span class="nv">Grid</span><span class="p">),</span> <span class="nv">Grid</span><span class="p">),</span>
  <span class="nf">nth1_matrix</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="nv">Grid</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
  <span class="nf">nth1_matrix</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="nv">Grid</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
  <span class="nf">nth1_matrix</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="nv">Grid</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
  <span class="nf">nth1_matrix</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nv">Grid</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
  <span class="nf">nth1_matrix</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="nv">Grid</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
  <span class="nv">Constraints</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="s s-Atom">&gt;</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span>
    <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="s s-Atom">&gt;</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="s s-Atom">&gt;</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span><span class="s s-Atom">&gt;</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span><span class="s s-Atom">&gt;</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">),</span>
    <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span><span class="s s-Atom">&gt;</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span>
    <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span><span class="s s-Atom">&gt;</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">7</span><span class="p">),</span>
    <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="s s-Atom">&gt;</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="s s-Atom">&gt;</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="s s-Atom">&lt;</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span>
    <span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="s s-Atom">&gt;</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="s s-Atom">&lt;</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span>
    <span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="s s-Atom">&gt;</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="s s-Atom">&gt;</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span><span class="s s-Atom">&lt;</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">7</span><span class="p">),</span>
    <span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="s s-Atom">&gt;</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span><span class="s s-Atom">&lt;</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">),</span>
    <span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="s s-Atom">&lt;</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="s s-Atom">&lt;</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="s s-Atom">&lt;</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
  <span class="p">],</span>
  <span class="nf">solve_futoshiki</span><span class="p">(</span><span class="nv">Grid</span><span class="p">,</span> <span class="nv">Constraints</span><span class="p">),</span>
  <span class="nf">write</span><span class="p">(</span><span class="nv">Grid</span><span class="p">).</span>
</pre></div>
<p>For fun, let's see how long Prolog takes to solve this:</p>
<div class="highlight"><pre><span></span><span class="s s-Atom">?-</span> <span class="nf">time</span><span class="p">(</span><span class="nf">test</span><span class="p">(</span><span class="mi">2</span><span class="p">)).</span>
<span class="p">[[</span><span class="mi">6</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">7</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">6</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">]]</span>
<span class="c1">% 407,146 inferences, 0.032 CPU in 0.034 seconds (96% CPU, 12554223 Lips)</span>
<span class="s s-Atom">true</span> <span class="p">.</span>
</pre></div>
<p>Taking roughly 0.034 seconds and half a million logical inferences (<a href="https://stackoverflow.com/questions/37604013/prolog-what-do-the-results-from-calling-time-1-actually-mean">what does this mean?</a>).</p>
<p>Prolog's nondeterminism also means that puzzles with multiple solutions solve correctly (Prolog can enumerate all of them). The following puzzle has two solutions, which our solver identifies:</p>
<figure class="styled"><img src="/images/futo-combined-3.png" width="500" height="250" title="A multi-solution 4x4 puzzle." alt="A multi-solution 4x4 puzzle."><figcaption>A multi-solution 4x4 puzzle. Initial configuration (left) and solution (right).</figcaption></figure><div class="highlight"><pre><span></span><span class="nf">test</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="p">:-</span>
  <span class="nv">Grid</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="k">_</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="k">_</span><span class="p">,</span> <span class="k">_</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="k">_</span><span class="p">,</span> <span class="k">_</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
    <span class="p">[</span><span class="k">_</span><span class="p">,</span> <span class="k">_</span><span class="p">,</span> <span class="k">_</span><span class="p">,</span> <span class="k">_</span><span class="p">],</span>
    <span class="p">[</span><span class="k">_</span><span class="p">,</span> <span class="k">_</span><span class="p">,</span> <span class="k">_</span><span class="p">,</span> <span class="k">_</span><span class="p">]</span>
  <span class="p">],</span>
  <span class="nv">Constraints</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="s s-Atom">&gt;</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="s s-Atom">&gt;</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span>
    <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="s s-Atom">&lt;</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span>
    <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="s s-Atom">&lt;</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
  <span class="p">],</span>
  <span class="nf">solve_futoshiki</span><span class="p">(</span><span class="nv">Grid</span><span class="p">,</span> <span class="nv">Constraints</span><span class="p">),</span>
  <span class="nf">write</span><span class="p">(</span><span class="nv">Grid</span><span class="p">).</span>
</pre></div>
<p>Since the 3-4 pair can be in either location, Prolog identifies the two configurations:</p>
<div class="highlight"><pre><span></span><span class="s s-Atom">?-</span> <span class="nf">test</span><span class="p">(</span><span class="mi">6</span><span class="p">).</span>
<span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]]</span>
<span class="s s-Atom">true</span> <span class="p">;</span>
<span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]]</span>
<span class="s s-Atom">true</span> <span class="p">;</span>
<span class="s s-Atom">false</span><span class="p">.</span>
</pre></div>
<p>And that's a small and simple Futoshiki solver. If you're interested in looking at the source code in one place, my efforts are available <a href="https://github.com/blademaw/futoshiki">on Github</a>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="NYT-Digits">NYT Digits<a class="anchor-link" href="#NYT-Digits">&#182;</a></h2><p>From April 10th to August 8th 2023, the New York Times published daily puzzles for a game they called <em>Digits</em>, a math puzzle game. They've since <a href="https://www.nytimes.com/games/digits">discontinued the game</a> (I guess it didn't have enough consistent players), but luckily it <a href="https://engaging-data.com/digits-archive/">still lives on</a> in good old internet fashion.</p>
<figure class="styled"><img src="/images/digits-ex-94.png" width=250 height=280 title="The first level of a daily Digits puzzle." alt="The first level of a daily Digits puzzle."><figcaption>The first level of a daily Digits puzzle.</figcaption></figure><p>In <em>Digits</em>, players are given a set of six numbers of which they have to apply the four arithmetic operations to (add, subtract, multiply, divide) in order to produce a target integer. Once used in an operation, two numbers create a new number, and you cannot reuse the old numbers. For example, the above puzzle has the solution $(4\times 25) - (1+5) = 100 - 6 = 94$.</p>
<p>At first blush, this game might seem impossible to translate into a Prolog solver, because it's unclear how predicates might come into play. However, approaching the problem from a "grammatical" viewpoint can make it easier to frame as a recursive problem:</p>
<p>Every solution to a Digits puzzle is an number derived from an expression, which itself is a combination of two expressions, and so on. We can enumerate the rules like so:</p>
$$
\begin{align*}
\text{Expr} &amp;\longrightarrow \text{Integer} \\
\text{Expr} &amp;\longrightarrow \text{Expr }+\text{ Expr} \\
\text{Expr} &amp;\longrightarrow \text{Expr }-\text{ Expr} \\
\text{Expr} &amp;\longrightarrow \text{Expr }\times\text{ Expr} \\
\text{Expr} &amp;\longrightarrow \text{Expr }\div\text{ Expr} \\
\end{align*}
$$<p>which, for example, allows us to visualize the derivation of the solution:</p>
<figure><img src="/images/parse-tree-digits.png" width=400 height=206></figure><p>Understanding how Prolog deals with expressions in this format is important to solving Digits, so one last detour before the solution:</p>
<h3 id="Prolog-arithmetic,-part-two">Prolog arithmetic, part two<a class="anchor-link" href="#Prolog-arithmetic,-part-two">&#182;</a></h3><p>Earlier in this post I mentioned "evaluating" expressions using the <code>is</code> keyword, but what does this really mean? In Prolog, variables assigned arithmetic expressions are not immediately evaluated — for example:</p>
<div class="highlight"><pre><span></span><span class="s s-Atom">?-</span> <span class="nv">X</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="nv">Y</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">-</span> <span class="mf">5.</span>
<span class="nv">X</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
<span class="nv">Y</span> <span class="o">=</span> <span class="mi">10</span><span class="o">-</span><span class="mf">5.</span>
</pre></div>
<p>in any other language, you would probably expect something like <code>Y = 5.</code>, but Prolog instead binds the variable to the <em>expression</em> that yields five.</p>
<p>Prolog also ensures no order-of-operations trickery happens when combining expressions, as it automatically adds parentheses to expressions:</p>
<div class="highlight"><pre><span></span><span class="s s-Atom">?-</span> <span class="nv">X</span> <span class="o">=</span> <span class="mi">7</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="nv">Y</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="nv">Z</span> <span class="o">=</span> <span class="nv">Y</span> <span class="o">-</span> <span class="nv">X</span><span class="p">.</span>
<span class="nv">X</span> <span class="o">=</span> <span class="mi">7</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span>
<span class="nv">Y</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
<span class="nv">Z</span> <span class="o">=</span> <span class="mi">10</span><span class="s s-Atom">-</span><span class="p">(</span><span class="mi">7</span><span class="o">-</span><span class="mi">2</span><span class="p">).</span>
</pre></div>
<p>Once variables hold expressions, we can <em>evaluate</em> them to yield the values:</p>
<div class="highlight"><pre><span></span><span class="s s-Atom">?-</span> <span class="nv">X</span> <span class="o">=</span> <span class="mi">7</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="nv">Y</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="nv">Z</span> <span class="o">=</span> <span class="nv">Y</span> <span class="o">-</span> <span class="nv">X</span><span class="p">,</span> <span class="nv">Val</span> <span class="o">is</span> <span class="nv">Z</span><span class="p">.</span>
<span class="nv">X</span> <span class="o">=</span> <span class="mi">7</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span>
<span class="nv">Y</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
<span class="nv">Z</span> <span class="o">=</span> <span class="mi">10</span><span class="s s-Atom">-</span><span class="p">(</span><span class="mi">7</span><span class="o">-</span><span class="mi">2</span><span class="p">),</span>
<span class="nv">Val</span> <span class="o">=</span> <span class="mf">5.</span>
</pre></div>
<p>So why is this relevant, and how can we use this to solve Digits?</p>
<h3 id="Solving-Digits">Solving Digits<a class="anchor-link" href="#Solving-Digits">&#182;</a></h3><p>The recursive nature of Digits and the grammar of arithmetic expressions means we can loosely form a naïve search strategy:</p>
<ul>
<li><strong>Base case</strong>: the expression we have constructed evaluates to the target number.</li>
<li><strong>Recursive case</strong>: from the set of available expressions (or integers), choose two and create a new expression via an arithmetic operation.</li>
</ul>
<p>Put simply, choosing two different expressions and combining them in some way either yields our target number, or a new expression to use later. Let's implement this strategy from the top-down:</p>
<div class="highlight"><pre><span></span><span class="c1">%% find_expr(+Available, +Cur, +Target, -Expr)</span>
<span class="c1">%</span>
<span class="c1">% Searches for an expression Expr using terms in Available that equals Target.</span>
<span class="c1">% Stores current accumulated expression in Cur.</span>

<span class="nf">find_expr</span><span class="p">(</span><span class="nv">Available</span><span class="p">,</span> <span class="nv">Cur</span><span class="p">,</span> <span class="nv">Target</span><span class="p">,</span> <span class="nv">Expr</span><span class="p">)</span> <span class="p">:-</span>
  <span class="p">(</span> <span class="nv">Cur</span> <span class="o">=:=</span> <span class="nv">Target</span> <span class="s s-Atom">-&gt;</span>
    <span class="nv">Expr</span> <span class="o">=</span> <span class="nv">Cur</span>
  <span class="p">;</span> <span class="c1">% otherwise, take two from available</span>
    <span class="nf">select</span><span class="p">(</span><span class="nv">E1</span><span class="p">,</span> <span class="nv">Available</span><span class="p">,</span> <span class="nv">A1</span><span class="p">),</span>
    <span class="nf">select</span><span class="p">(</span><span class="nv">E2</span><span class="p">,</span> <span class="nv">A1</span><span class="p">,</span> <span class="nv">A2</span><span class="p">),</span>
    <span class="nf">transform_expr</span><span class="p">(</span><span class="nv">E1</span><span class="p">,</span> <span class="nv">E2</span><span class="p">,</span> <span class="nv">NewExpr</span><span class="p">),</span>
    <span class="nv">NewAvailable</span> <span class="o">=</span> <span class="p">[</span><span class="nv">NewExpr</span> <span class="p">|</span> <span class="nv">A2</span><span class="p">],</span>
    <span class="nf">find_expr</span><span class="p">(</span><span class="nv">NewAvailable</span><span class="p">,</span> <span class="nv">NewExpr</span><span class="p">,</span> <span class="nv">Target</span><span class="p">,</span> <span class="nv">Expr</span><span class="p">)</span>
  <span class="p">).</span>
</pre></div>
<p>First, we tell Prolog that if our current expression <code>Cur</code> evaluates to <code>Target</code>, we should stop the search and bind to the expression <code>Expr</code>. In the recursive case, we take two expressions <code>E1</code> and <code>E2</code> from the current pool of expressions and combine them in some way, before adding the new expression to the pool and recursing.</p>
<p>Of course, we now need a way to transform two expressions:</p>
<div class="highlight"><pre><span></span><span class="c1">%% transform_expr(+Expr1, +Expr2, -NewExpr)</span>
<span class="c1">%</span>
<span class="c1">% Enumerates all ways to combine two expressions Expr1 and Expr2 with the four</span>
<span class="c1">% operations of arithmetic, yielding a new expression NewExpr.</span>
<span class="nf">transform_expr</span><span class="p">(</span><span class="nv">Expr1</span><span class="p">,</span> <span class="nv">Expr2</span><span class="p">,</span> <span class="nv">NewExpr</span><span class="p">)</span> <span class="p">:-</span>
  <span class="p">(</span> 
    <span class="nv">NewExpr</span> <span class="o">=</span> <span class="nv">Expr1</span> <span class="o">+</span> <span class="nv">Expr2</span> <span class="p">;</span>
    <span class="nv">NewExpr</span> <span class="o">=</span> <span class="nv">Expr1</span> <span class="o">-</span> <span class="nv">Expr2</span> <span class="p">;</span>
    <span class="nv">NewExpr</span> <span class="o">=</span> <span class="nv">Expr1</span> <span class="o">*</span> <span class="nv">Expr2</span> <span class="p">;</span>
    <span class="nv">NewExpr</span> <span class="o">=</span> <span class="nv">Expr1</span> <span class="o">/</span> <span class="nv">Expr2</span> 
  <span class="p">),</span>
  <span class="nv">EvalNewNum</span> <span class="o">is</span> <span class="nv">NewExpr</span><span class="p">,</span>
  <span class="nv">EvalNewNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span>
  <span class="nf">integer</span><span class="p">(</span><span class="nv">EvalNewNum</span><span class="p">).</span>
</pre></div>
<p>This is where Prolog's representation of arithmetic comes in handy: Prolog essentially has the grammar we defined earlier built into it, not only allowing us to combine expressions with ease, but storing expressions in variables means we don't have to do any fancy backtracking to trace solution derivations.</p>
<p>The above predicate simply takes two expressions, and says that a "transformed" new expression <code>NewExpr</code> combining the two must use one of the four arithmetic operations and must also result in a positive integer (when evaluated). That's it — for completeness, I'll define a final predicate as an interface to write the results:</p>
<div class="highlight"><pre><span></span><span class="c1">%% solve_digits(+Nums, +Target)</span>
<span class="c1">%</span>
<span class="c1">% Solves the NYT game &quot;Digits&quot; by taking in a list of available starting</span>
<span class="c1">% numbers Nums, and a target number Target.</span>

<span class="nf">solve_digits</span><span class="p">(</span><span class="nv">Nums</span><span class="p">,</span> <span class="nv">Target</span><span class="p">)</span> <span class="p">:-</span>
  <span class="nf">find_expr</span><span class="p">(</span><span class="nv">Nums</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nv">Target</span><span class="p">,</span> <span class="nv">Expr</span><span class="p">),</span>
  <span class="nf">format</span><span class="p">(</span><span class="s s-Atom">&#39;~w~25| = ~w~n&#39;</span><span class="p">,</span> <span class="p">[</span><span class="nv">Expr</span><span class="p">,</span> <span class="nv">Target</span><span class="p">]).</span>
</pre></div>
<p>Which produces the solution to the above example:</p>
<div class="highlight"><pre><span></span><span class="s s-Atom">?-</span> <span class="nf">time</span><span class="p">(</span><span class="nf">solve_digits</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">25</span><span class="p">],</span> <span class="mi">94</span><span class="p">)).</span>
<span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mi">2</span><span class="o">+</span><span class="mi">10</span><span class="p">)</span><span class="o">*</span><span class="mi">5</span><span class="o">+</span><span class="mi">4</span><span class="o">+</span><span class="mi">25</span>           <span class="o">=</span> <span class="mi">94</span>
<span class="c1">% 145,950 inferences, 0.008 CPU in 0.008 seconds (100% CPU, 17575867 Lips)</span>
<span class="s s-Atom">true</span> <span class="p">.</span>
</pre></div>
<p>And does so in less than 0.01 seconds. It also solves the hardest puzzle of the last day the game was playable:</p>
<figure class="styled"><img src="/images/digits-ex-424.png" width=250 height=315 title="A harder Digits puzzle." alt="A harder Digits puzzle."><figcaption>A harder Digits puzzle.</figcaption></figure><div class="highlight"><pre><span></span><span class="s s-Atom">?-</span> <span class="nf">time</span><span class="p">(</span><span class="nf">solve_digits</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">19</span><span class="p">,</span><span class="mi">23</span><span class="p">,</span><span class="mi">25</span><span class="p">],</span> <span class="mi">424</span><span class="p">)).</span>
<span class="mi">23</span><span class="o">*</span><span class="mi">25</span><span class="s s-Atom">-</span><span class="p">((</span><span class="mi">3</span><span class="o">+</span><span class="mi">9</span><span class="p">)</span><span class="o">*</span><span class="mi">11</span><span class="o">+</span><span class="mi">19</span><span class="p">)</span>       <span class="o">=</span> <span class="mi">424</span>
<span class="c1">% 72,163 inferences, 0.011 CPU in 0.011 seconds (98% CPU, 6792451 Lips)</span>
<span class="s s-Atom">true</span> <span class="p">.</span>
</pre></div>
<p>...in about half the inferences!</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Conclusion">Conclusion<a class="anchor-link" href="#Conclusion">&#182;</a></h2><p>None of the above three puzzles are particularly challenging or computationally difficult. They <em>could</em> be solved in other languages, but the point is that Prolog was designed exactly for the kind of problems exhibited in this post, and it really shows. Modeling problems in Prolog <em>feels</em> satisfying, regardless of whether implementations are rough and inefficient (like in the circular primes problem), or well-defined systems of constraints (like in Futoshiki).</p>
<p>There is also a practical incentive for using Prolog: more often than not, modeling CSPs or other problems in Prolog just makes sense — why should I go to the trouble of building my own backtracking or dynamic programming algorithm for every scenario I face, when I could benefit from Prolog's inference engine and great libraries like CLP(FD)/CLP(Z)?</p>
<p>Hopefully this post has given you a reason to try out a new language, or at least share some appreciation of an awesome tool lesser-known to the common programmer.</p>

</div>
</div>
</div>
 

<style type="text/css"> div.collapseheader {
    width=100%;
    background-color:#d3d3d3;
    padding: 2px;
    cursor: pointer;
    font-family:"Helvetica Neue",Helvetica,Arial,sans-serif;
}
</style>

<script type="text/javascript">
jQuery(document).ready(function($) {
    $("div.collapseheader").click(function () {
    $header = $(this).children("span").first();
    $codearea = $(this).children(".input_area");
    console.log($(this).children());
    $codearea.slideToggle(500, function () {
        $header.text(function () {
            return $codearea.is(":visible") ? "Collapse Code" : "Expand Code";
        });
    });
});
});
</script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'] ],
        processEscapes: true,
        preview: 'TeX'
    }
});
</script>

<script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML">
</script>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
        </div>

        <div class="meta">
            <div>
                    <a href="https://blademaw.github.io/tag/prolog.html" class="tag">prolog</a>
                    <a href="https://blademaw.github.io/tag/programming.html" class="tag">programming</a>
                    <a href="https://blademaw.github.io/tag/logic.html" class="tag">logic</a>
            </div>
        </div>
    </article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div>
    <script type="text/javascript">
      var disqus_shortname = 'blademaw-blog';
      var disqus_identifier = '/posts/2023/07/prolog-puzzles/';
      var disqus_url = 'https://blademaw.github.io/posts/2023/07/prolog-puzzles/';
      var disqus_title = 'Solving Logic Puzzles in Prolog';
      (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = "//" + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      })();
    </script>
  </section>

</div>

<style type="text/css">
{
    max-width: 700px;
}

strong { font-weight: bold; }

.text_cell .prompt {
    display: none;
}

div.cell {
    padding: 0;
}

div.text_cell_render {
    padding: 0;
}

div.prompt {
    font-size: 13px;
}

div.input_prompt {
    padding: .7em 0.2em;
}

div.output_prompt {
    padding: .4em .2em;
}

div.input_area {
    margin: .2em 0.4em;
    max-width: 580px;
}

table.dataframe {
    font-family: Arial, sans-serif;
    font-size: 13px;
    line-height: 20px;
}

table.dataframe th, td {
    padding: 4px;
    text-align: left;
}

pre code {
    background-color: inherit;
}body {
  margin: 0;
  padding: 0;
  font: 15px 'Source Sans Pro', sans-serif;
  line-height: 1.6em;
  color: #222;
  text-rendering: optimizeLegibility;
  -webkit-font-smoothing: antialiased;
}

a {
  color: #007EE5;
  text-decoration: none;
}
a:hover {
  color: #007EE5;
  text-decoration: none;
}
header.main-header {
  background: none repeat scroll 0% 0% #205F29;
  margin-bottom: 20px;
}
header.main-header a {
  color: #fff;
}
header.main-header .container {
  max-width: 1000px;
}
header.main-header .container nav a:hover {
  background-color: #5C881C;
}
article {
  margin: 0;
}
article header.about {
  margin-bottom: 0px;
  padding-bottom: 0px;
}
article header {
  margin-bottom: 20px;
  padding-bottom: 20px;
}
article header h1 {
  margin-bottom: 2px;
  font-weight: 700;
  color: #000;
}
article header time {
  color: #9E9E9E;
  font-size: 0.85em;
  float: right;
}
article header time.left {
  color: #9E9E9E;
  font-size: 0.85em;
  float: left;
}
article div.social-links ul {
  padding: 0px;
}
article div.social-links li {
  display: inline;
  font-size: 20px;
}
article div.social-links li a {
  color: #000;
  padding: 10px;
}
article div.social-links li a:hover {
  color: #666;
  text-decoration: none;
}
article p {
  font-size: 16px;
  margin-bottom: 20px;
  line-height: 1.6em;
}
article p.note {
  background: #f5f5f5;
  border: 1px solid #ddd;
  padding: 0.533em 0.733em;
}
article p.update {
  background-color: #FEEFB3;
  border: 1px solid #e6e68a;
  padding: 0.533em 0.733em;
}
article p.alert {
  background-color: #ffe2e2;
  border: 1px solid #ffb2b2;
  padding: 0.533em 0.733em;
}
article ul,
article ol {
  margin-top: 0px;
  margin-bottom: 25px;
}
article li {
  font-size: 16px;
  line-height: 1.6em;
}
article a:hover {
  text-decoration: underline;
}
article blockquote {
  border-left: 2px solid #c7c7cc;
  color: #666;
  margin: 30px 0;
  padding: 0 0 0 25px;
}
article img {
  max-width: 100%;
}
article code {
  color: #333;
  background-color: #EEE;
  border-radius: 0;
  font-size: 13px;
}
article .meta {
  font-size: 11px;
}
article .meta a:hover {
  text-decoration: none;
}
article .meta div {
  margin-bottom: 20px;
  display: block;
}
article .meta a.tag {
  margin: 0 10px 10px 0;
  padding: 1px 12px;
  display: inline-block;
  font-size: 14px;
  color: rgba(0, 0, 0, 0.8);
  background: rgba(0, 0, 0, 0.05);
}
article .meta a.tag:hover {
  background: rgba(0, 0, 0, 0.15);
}
article .meta a.read_more,
article .meta a.comments_btn {
  font-size: 14px;
  font-weight: 800;
  padding: 10px 20px;
  color: #205F29;
  background: #FFF;
  border: 1px solid #205F29;
}
article .meta a.read_more:hover,
article .meta a.comments_btn:hover {
  color: #FFF;
  background: #5C881C;
}
.index {
  max-width: 700px;
}
.index article header h2 {
  font-size: 36px;
  margin-bottom: 2px;
  font-weight: 700;
}
h2 code {
  font-size: 26px;
  font-weight: 400;
}
h3 code {
  font-size: 20px;
  font-weight: 400;
}
.index article header h2 a {
  color: #000;
}
.index article header h2 a:hover {
  color: #007EE5;
  text-decoration: none;
}
.index .separator {
  padding: 40px 0 0 0;
  margin: 0 0 40px 0;
  height: 10px;
  border-bottom: solid 1px #CCC;
}
.index .pagination {
  display: block;
  margin-bottom: 100px;
}
.index .pagination .left {
  text-align: right;
}
.index .pagination .right {
  text-align: left;
}
.index .pagination a {
  display: inline-block;
  border: 2px solid #5C881C;
  margin: 0 5px;
  padding: 8px 20px;
  font-weight: bold;
  color: #5C881C;
}
.index .pagination a:hover {
  color: #FFF;
  background: #5C881C;
}
.post {
  max-width: 700px;
}
.post h2:before {
  content: "# ";
  font-weight: bold;
  color: #DDD;
}
.post h3:before {
  content: "## ";
  font-weight: bold;
  color: #DDD;
}
.post h4:before {
  content: "### ";
  font-weight: bold;
  color: #DDD;
}
.post article .meta {
  margin: 50px 0 100px;
}
.list {
  max-width: 700px;
}
.list ul.double-list {
  margin: 0 auto 60px;
  padding: 0;
  list-style-type: none;
}
.list ul.double-list li {
  padding: 5px 0;
}
.list ul.double-list li h2 {
  font-size: 1em;
  display: inline;
  font-weight: normal;
}
.list ul.double-list li span {
  font-family: sans-serif;
  text-transform: uppercase;
  text-align: right;
  float: right;
  padding-top: 3px;
  font-size: 12px;
  color: #999;
}
.full-width-content {
  padding-top: 10px;
  padding-left: 0px;
  padding-right: 0px;
  margin-left: -20px;
  margin-right: -20px;
}
.col-xs-1,
.col-sm-1,
.col-md-1,
.col-lg-1,
.col-xs-2,
.col-sm-2,
.col-md-2,
.col-lg-2,
.col-xs-3,
.col-sm-3,
.col-md-3,
.col-lg-3,
.col-xs-4,
.col-sm-4,
.col-md-4,
.col-lg-4,
.col-xs-5,
.col-sm-5,
.col-md-5,
.col-lg-5,
.col-xs-6,
.col-sm-6,
.col-md-6,
.col-lg-6,
.col-xs-7,
.col-sm-7,
.col-md-7,
.col-lg-7,
.col-xs-8,
.col-sm-8,
.col-md-8,
.col-lg-8,
.col-xs-9,
.col-sm-9,
.col-md-9,
.col-lg-9,
.col-xs-10,
.col-sm-10,
.col-md-10,
.col-lg-10,
.col-xs-11,
.col-sm-11,
.col-md-11,
.col-lg-11,
.col-xs-12,
.col-sm-12,
.col-md-12,
.col-lg-12 {
  padding-right: 0px;
  padding-left: 0px;
}

figure {
  text-align: center;
}

td.code {
  width: 100%;
}

figure.code {
  text-align: left;
}

figure.styled {
  padding-top: 1rem;
  padding-bottom: 1rem;
  padding-left: 2rem;
  padding-right: 2rem;
  margin-left: -2rem;
  margin-right: -2rem;
  background: repeating-linear-gradient(135deg, #dfdfdf 0, #dfdfdf 1%, #ffffff 0, #ffffff 50%) 0 / 20px 20px;
  text-align: center;
  img {
      margin: 0 auto 0.2rem auto;
      border: 1px solid #ddd;
      box-shadow: none;
      background-color: #fff;
  }
}
figcaption {
  text-align: center;
  font-size: 1.2rem;
  padding-left: 2rem;
  padding-right: 2rem;
  line-height: 1.6;
  font-family: Consolas, monaco, monospace;
  span {
      background-color: #fff;
      padding: 0.2rem 0.5rem;
  }
  a:hover {
      cursor: pointer;
  }
}

.vis-container {
  padding-top: 1rem;
  padding-bottom: 1rem;
  padding-left: 2rem;
  padding-right: 2rem;
  margin-left: -2rem;
  margin-right: -2rem;
  background: repeating-linear-gradient(135deg, #dfdfdf 0, #dfdfdf 1%, #ffffff 0, #ffffff 50%) 0 / 20px 20px;
  width: 100%;
  margin:0 auto;
}

#cent {
  text-align: center;
}

.proj-contents {
  width: 80%;
  text-align: left;
  padding: 2%;
  /* justify-content: flex-start; */
}

.proj-contents p {
  margin: 0;
}

.paperimg {
  object-fit: cover;
  width: 100%;
  height: 100px;
  z-index: 1;
}

.proj-img {
  width: 20%;
  height: 100%;
}

.proj-row {
  width: 100%;
  display: flex;
  flex-direction: row;
  justify-content: space-between;
  align-items: center;
  background: rgb(228, 228, 228);
}

.projs {
  display: flex;
  flex-direction: column;
  /* background: rgb(241, 241, 241); */
  padding: 2%;
  row-gap: 25px;
  /* align-items: flex-start; */
  width: 100%;
  margin: 0 auto;
}</style>

        </div>

        <script>
        $(function() {


            $('ul.nav li.dropdown').hover(function() {
                $('.dropdown-menu', this).fadeIn('fast');
            }, function() {
                $('.dropdown-menu', this).fadeOut('fast');
            });
            
                }); 
        </script>
<!--
    <footer>
      <p>
        © 2021 Jack Oliver unless otherwise noted.
        Generated by <a href= "http://docs.getpelican.com/">Pelican</a>.
      </p>
    </footer>
-->
    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-208210830-1']);
    _gaq.push(['_trackPageview']);
    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();

    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-208210830-1');
    ga('send', 'pageview');
</script>
    </body>
</html>